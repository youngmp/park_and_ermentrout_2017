(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     93727,       2402]
NotebookOptionsPosition[     91372,       2322]
NotebookOutlinePosition[     91710,       2337]
CellTagsIndexPosition[     91667,       2334]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"N", " ", "terms"}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.694466674960383*^9, 3.694466678060794*^9}, 
   3.69456739431255*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"bound", "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"K", "[", 
    RowBox[{"x", ",", "y"}], "]"}], ":=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Subscript", "[", 
         RowBox[{"a", ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "j"}], "}"}]}], "]"}], 
        RowBox[{"Cos", "[", 
         RowBox[{"i", " ", "x"}], "]"}], 
        RowBox[{"Cos", "[", 
         RowBox[{"j", " ", "y"}], "]"}], 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Abs", "[", "i", "]"}], "+", 
           RowBox[{"Abs", "[", "j", "]"}]}], "\[LessEqual]", " ", "sum"}], 
         "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", 
         RowBox[{"-", "bound"}], ",", "bound"}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"-", "bound"}], ",", "bound"}], "}"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.694457058358838*^9, 3.694457084778378*^9}, {
  3.6944580341793337`*^9, 3.694458176867959*^9}, {3.6944582207079697`*^9, 
  3.694458229731906*^9}, {3.694458279411805*^9, 3.694458280555922*^9}, {
  3.6944584698923597`*^9, 3.694458547020132*^9}, {3.6944586395805817`*^9, 
  3.6944586963407516`*^9}, {3.694458751702211*^9, 3.694458766700808*^9}, {
  3.694458897799005*^9, 3.6944589324066668`*^9}, {3.6945673282890053`*^9, 
  3.694567335248424*^9}, {3.6945673999288197`*^9, 3.694567410112475*^9}, {
  3.694570194692121*^9, 3.694570195667534*^9}, {3.6948021165877132`*^9, 
  3.694802140468075*^9}, {3.694806216136261*^9, 3.694806222592432*^9}, {
  3.694806310312119*^9, 3.6948063103918943`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"replace", " ", "boole", " ", "as", " ", "needed"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Boole", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Abs", "[", "i", "]"}], "\[LessEqual]", "1"}], "&&", 
     RowBox[{
      RowBox[{"Abs", "[", "j", "]"}], "\[LessEqual]", "1"}]}], "]"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Boole", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Abs", "[", "i", "]"}], "+", 
      RowBox[{"Abs", "[", "j", "]"}]}], "\[LessEqual]", "2"}], "]"}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Boole", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Abs", "[", "i", "]"}], "+", 
       RowBox[{"Abs", "[", "j", "]"}]}], "\[LessEqual]", "3"}], "&&", " ", 
     RowBox[{
      RowBox[{"Abs", "[", 
       RowBox[{
        RowBox[{"Abs", "[", "i", "]"}], "-", 
        RowBox[{"Abs", "[", "j", "]"}]}], "]"}], "<", "3"}]}], "]"}], 
   "*)"}]}]], "Input",
 CellChangeTimes->{{3.694570202060451*^9, 3.694570242395644*^9}, {
   3.6945830999053297`*^9, 3.694583103249526*^9}, 3.694588003527656*^9, 
   3.694588917864933*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"u0", "[", 
   RowBox[{"w", ",", "z"}], "]"}], "=", 
  RowBox[{
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Subscript", "[", 
         RowBox[{"u", ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "j"}], "}"}]}], "]"}], 
        RowBox[{"Cos", "[", 
         RowBox[{"i", " ", "w"}], "]"}], 
        RowBox[{"Cos", "[", 
         RowBox[{"j", " ", "z"}], "]"}], 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Abs", "[", "i", "]"}], "+", 
            RowBox[{"Abs", "[", "j", "]"}]}], "\[LessEqual]", "bound"}], "&&",
           " ", 
          RowBox[{
           RowBox[{"Abs", "[", 
            RowBox[{
             RowBox[{"Abs", "[", "i", "]"}], "-", 
             RowBox[{"Abs", "[", "j", "]"}]}], "]"}], "<", "bound"}]}], 
         "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"-", "bound"}], ",", "bound"}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", 
       RowBox[{"-", "bound"}], ",", "bound"}], "}"}]}], "]"}], "/.", 
   RowBox[{
    RowBox[{"Subscript", "[", 
     RowBox[{"u_", ",", 
      RowBox[{"{", 
       RowBox[{"x_", ",", "y_"}], "}"}]}], "]"}], "\[RuleDelayed]", 
    RowBox[{"Symbol", "[", 
     RowBox[{"\"\<u\>\"", "<>", 
      RowBox[{"ToString", "[", 
       RowBox[{"Abs", "[", "x", "]"}], "]"}], "<>", 
      RowBox[{"ToString", "[", 
       RowBox[{"Abs", "[", "y", "]"}], "]"}]}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.694801491557415*^9, 3.694801785711297*^9}, {
  3.69480214317992*^9, 3.694802171476121*^9}, {3.694802223451798*^9, 
  3.694802290843886*^9}, {3.69480232697265*^9, 3.6948023421159697`*^9}, {
  3.694802428556185*^9, 3.694802430139873*^9}, {3.694802806612825*^9, 
  3.694802821284374*^9}, {3.694802880532585*^9, 3.694802928444759*^9}, {
  3.6948034740291777`*^9, 3.694803488007223*^9}, {3.6948035570696087`*^9, 
  3.694803574765432*^9}}],

Cell[BoxData[
 RowBox[{"u00", "+", 
  RowBox[{"2", " ", "u10", " ", 
   RowBox[{"Cos", "[", "w", "]"}]}], "+", 
  RowBox[{"2", " ", "u20", " ", 
   RowBox[{"Cos", "[", 
    RowBox[{"2", " ", "w"}], "]"}]}], "+", 
  RowBox[{"2", " ", "u01", " ", 
   RowBox[{"Cos", "[", "z", "]"}]}], "+", 
  RowBox[{"4", " ", "u11", " ", 
   RowBox[{"Cos", "[", "w", "]"}], " ", 
   RowBox[{"Cos", "[", "z", "]"}]}], "+", 
  RowBox[{"4", " ", "u21", " ", 
   RowBox[{"Cos", "[", 
    RowBox[{"2", " ", "w"}], "]"}], " ", 
   RowBox[{"Cos", "[", "z", "]"}]}], "+", 
  RowBox[{"2", " ", "u02", " ", 
   RowBox[{"Cos", "[", 
    RowBox[{"2", " ", "z"}], "]"}]}], "+", 
  RowBox[{"4", " ", "u12", " ", 
   RowBox[{"Cos", "[", "w", "]"}], " ", 
   RowBox[{"Cos", "[", 
    RowBox[{"2", " ", "z"}], "]"}]}]}]], "Output",
 CellChangeTimes->{{3.694803575080998*^9, 3.694803590942368*^9}, {
   3.694806218504784*^9, 3.694806223596365*^9}, 3.69480631193303*^9, 
   3.694807104940818*^9, 3.694807145716467*^9, 3.694807207970755*^9, {
   3.69481994442153*^9, 3.694819962769191*^9}, 3.695146504480777*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"u0", "[", 
     RowBox[{"w", ",", "z"}], "]"}], "/.", 
    RowBox[{"w", "\[Rule]", "x"}]}], "/.", 
   RowBox[{"z", "\[Rule]", "y"}]}], "//", 
  "FortranForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"u0", "[", 
    RowBox[{"w", ",", "z"}], "]"}], "/.", 
   RowBox[{"w", "\[Rule]", "x"}]}], "/.", 
  RowBox[{"z", "\[Rule]", "y"}]}]}], "Input",
 CellChangeTimes->{{3.69478562932828*^9, 3.694785641395714*^9}, {
  3.6947880393241777`*^9, 3.694788045115697*^9}}],

Cell[BoxData[
 RowBox[{"u00", "+", 
  RowBox[{"2", " ", "u10", " ", 
   RowBox[{"Cos", "[", "x", "]"}]}], "+", 
  RowBox[{"2", " ", "u20", " ", 
   RowBox[{"Cos", "[", 
    RowBox[{"2", " ", "x"}], "]"}]}], "+", 
  RowBox[{"2", " ", "u01", " ", 
   RowBox[{"Cos", "[", "y", "]"}]}], "+", 
  RowBox[{"4", " ", "u11", " ", 
   RowBox[{"Cos", "[", "x", "]"}], " ", 
   RowBox[{"Cos", "[", "y", "]"}]}], "+", 
  RowBox[{"4", " ", "u21", " ", 
   RowBox[{"Cos", "[", 
    RowBox[{"2", " ", "x"}], "]"}], " ", 
   RowBox[{"Cos", "[", "y", "]"}]}], "+", 
  RowBox[{"2", " ", "u02", " ", 
   RowBox[{"Cos", "[", 
    RowBox[{"2", " ", "y"}], "]"}]}], "+", 
  RowBox[{"4", " ", "u12", " ", 
   RowBox[{"Cos", "[", "x", "]"}], " ", 
   RowBox[{"Cos", "[", 
    RowBox[{"2", " ", "y"}], "]"}]}]}]], "Output",
 CellChangeTimes->{{3.6947856426081038`*^9, 3.694785645604457*^9}, 
   3.694788047240563*^9, 3.694798483436541*^9, 3.6948013876857967`*^9, 
   3.694803179765593*^9, 3.694803287154457*^9, 3.694803590973209*^9, {
   3.694806218536654*^9, 3.6948062236210546`*^9}, 3.694806311961803*^9, 
   3.6948071049741364`*^9, 3.694807145756277*^9, 3.694807208004043*^9, {
   3.694819944506633*^9, 3.6948199628526983`*^9}, 3.695146504562351*^9}],

Cell["\<\
u00 + 2*u10*Cos(x) + 2*u20*Cos(2*x) + 2*u01*Cos(y) + 4*u11*Cos(x)*Cos(y) + \
4*u21*Cos(2*x)*Cos(y) + 2*u02*Cos(2*y) + 4*u12*Cos(x)*Cos(2*y)\
\>", "Output",
 CellChangeTimes->{{3.6947856426081038`*^9, 3.694785645604457*^9}, 
   3.694788047240563*^9, 3.694798483436541*^9, 3.6948013876857967`*^9, 
   3.694803179765593*^9, 3.694803287154457*^9, 3.694803590973209*^9, {
   3.694806218536654*^9, 3.6948062236210546`*^9}, 3.694806311961803*^9, 
   3.6948071049741364`*^9, 3.694807145756277*^9, 3.694807208004043*^9, {
   3.694819944506633*^9, 3.6948199628526983`*^9}, 3.695146504563436*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"TrigExpand", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"u0", "[", 
      RowBox[{"w", ",", "z"}], "]"}], "/.", 
     RowBox[{"w", "\[Rule]", 
      RowBox[{"x", "+", "\[Theta]1"}]}]}], "/.", 
    RowBox[{"z", "\[Rule]", 
     RowBox[{"y", "+", "\[Theta]2"}]}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.694464874163329*^9, 3.694464915735058*^9}, {
   3.694546970130741*^9, 3.694546974268653*^9}, 3.694568372905518*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"u0", "[", 
       RowBox[{"w", ",", "z"}], "]"}], ",", "w"}], "]"}], "/.", 
    RowBox[{"w", "\[Rule]", "x"}]}], "/.", 
   RowBox[{"z", "\[Rule]", "y"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.694546987146315*^9, 3.6945469979702272`*^9}, {
  3.694568367329681*^9, 3.694568371729269*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Hpart1", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"u0", "[", 
       RowBox[{"w", ",", "z"}], "]"}], ",", "w"}], "]"}], "/.", 
    RowBox[{"w", "\[Rule]", "x"}]}], "/.", 
   RowBox[{"z", "\[Rule]", "y"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"Hpart2", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"u0", "[", 
     RowBox[{"w", ",", "z"}], "]"}], "/.", 
    RowBox[{"w", "->", 
     RowBox[{"x", "+", "\[Theta]1"}]}]}], "/.", 
   RowBox[{"z", "\[Rule]", 
    RowBox[{"y", "+", "\[Theta]2"}]}]}]}]}], "Input",
 CellChangeTimes->{{3.69446431650253*^9, 3.694464364450124*^9}, {
   3.694464397122498*^9, 3.694464439002543*^9}, {3.694464506402409*^9, 
   3.694464525683094*^9}, {3.6944649251871843`*^9, 3.694464950331366*^9}, {
   3.69446500413142*^9, 3.694465035715081*^9}, {3.694465078925178*^9, 
   3.69446508878724*^9}, {3.694547018538163*^9, 3.69454702070604*^9}, {
   3.6945661569912558`*^9, 3.694566160247755*^9}, {3.694566215743072*^9, 
   3.694566250727148*^9}, {3.694567542881042*^9, 3.694567548760545*^9}, {
   3.6945683644011497`*^9, 3.6945683710811872`*^9}, {3.694569391010614*^9, 
   3.6945693999626427`*^9}, {3.694569434075364*^9, 3.694569435484531*^9}, 
   3.694588880888829*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "2"}], " ", "u10", " ", 
   RowBox[{"Sin", "[", "x", "]"}]}], "-", 
  RowBox[{"4", " ", "u11", " ", 
   RowBox[{"Cos", "[", "y", "]"}], " ", 
   RowBox[{"Sin", "[", "x", "]"}]}], "-", 
  RowBox[{"4", " ", "u12", " ", 
   RowBox[{"Cos", "[", 
    RowBox[{"2", " ", "y"}], "]"}], " ", 
   RowBox[{"Sin", "[", "x", "]"}]}], "-", 
  RowBox[{"4", " ", "u20", " ", 
   RowBox[{"Sin", "[", 
    RowBox[{"2", " ", "x"}], "]"}]}], "-", 
  RowBox[{"8", " ", "u21", " ", 
   RowBox[{"Cos", "[", "y", "]"}], " ", 
   RowBox[{"Sin", "[", 
    RowBox[{"2", " ", "x"}], "]"}]}]}]], "Output",
 CellChangeTimes->{{3.694569391129826*^9, 3.694569400181933*^9}, 
   3.694569436667186*^9, 3.694570173744925*^9, 3.694570247660407*^9, 
   3.694576792153418*^9, 3.6945769024256973`*^9, 3.694588559484487*^9, 
   3.694588881227367*^9, 3.694588944236657*^9, 3.694589178545912*^9, 
   3.694589302040269*^9, 3.694589394111577*^9, 3.694589476424193*^9, 
   3.6947160560146008`*^9, 3.694785645647344*^9, 3.6947984835246563`*^9, 
   3.6948013877403793`*^9, 3.694803179809537*^9, 3.694803287195806*^9, 
   3.694803591014824*^9, {3.694806218572818*^9, 3.694806223655375*^9}, 
   3.694806312014349*^9, 3.694807105026775*^9, 3.69480714580235*^9, 
   3.694807208056501*^9, {3.694819944708239*^9, 3.6948199630467052`*^9}, 
   3.695146504762086*^9}],

Cell[BoxData[
 RowBox[{"u00", "+", 
  RowBox[{"2", " ", "u10", " ", 
   RowBox[{"Cos", "[", 
    RowBox[{"x", "+", "\[Theta]1"}], "]"}]}], "+", 
  RowBox[{"2", " ", "u20", " ", 
   RowBox[{"Cos", "[", 
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{"x", "+", "\[Theta]1"}], ")"}]}], "]"}]}], "+", 
  RowBox[{"2", " ", "u01", " ", 
   RowBox[{"Cos", "[", 
    RowBox[{"y", "+", "\[Theta]2"}], "]"}]}], "+", 
  RowBox[{"4", " ", "u11", " ", 
   RowBox[{"Cos", "[", 
    RowBox[{"x", "+", "\[Theta]1"}], "]"}], " ", 
   RowBox[{"Cos", "[", 
    RowBox[{"y", "+", "\[Theta]2"}], "]"}]}], "+", 
  RowBox[{"4", " ", "u21", " ", 
   RowBox[{"Cos", "[", 
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{"x", "+", "\[Theta]1"}], ")"}]}], "]"}], " ", 
   RowBox[{"Cos", "[", 
    RowBox[{"y", "+", "\[Theta]2"}], "]"}]}], "+", 
  RowBox[{"2", " ", "u02", " ", 
   RowBox[{"Cos", "[", 
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{"y", "+", "\[Theta]2"}], ")"}]}], "]"}]}], "+", 
  RowBox[{"4", " ", "u12", " ", 
   RowBox[{"Cos", "[", 
    RowBox[{"x", "+", "\[Theta]1"}], "]"}], " ", 
   RowBox[{"Cos", "[", 
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{"y", "+", "\[Theta]2"}], ")"}]}], "]"}]}]}]], "Output",
 CellChangeTimes->{{3.694569391129826*^9, 3.694569400181933*^9}, 
   3.694569436667186*^9, 3.694570173744925*^9, 3.694570247660407*^9, 
   3.694576792153418*^9, 3.6945769024256973`*^9, 3.694588559484487*^9, 
   3.694588881227367*^9, 3.694588944236657*^9, 3.694589178545912*^9, 
   3.694589302040269*^9, 3.694589394111577*^9, 3.694589476424193*^9, 
   3.6947160560146008`*^9, 3.694785645647344*^9, 3.6947984835246563`*^9, 
   3.6948013877403793`*^9, 3.694803179809537*^9, 3.694803287195806*^9, 
   3.694803591014824*^9, {3.694806218572818*^9, 3.694806223655375*^9}, 
   3.694806312014349*^9, 3.694807105026775*^9, 3.69480714580235*^9, 
   3.694807208056501*^9, {3.694819944708239*^9, 3.6948199630467052`*^9}, 
   3.695146504763465*^9}]
}, Open  ]],

Cell["\<\
Note here that the derivative is an odd function. therefore multiplication \
with any even function will go away. the only terms that matter are the odd \
functions. So we extract the odd part of the second term in the produc (named \
hpart2 above) by taking f(x)-f(-x). We do this for the x variable. For the y \
variable, the odd functions are removed, so we look for the even terms found \
by taking f(x)+f(-x).\
\>", "Text",
 CellChangeTimes->{{3.694566774007329*^9, 3.694566811423554*^9}, {
  3.6945668958083763`*^9, 3.6945669113116627`*^9}, {3.694567032447859*^9, 
  3.694567040815803*^9}, {3.694569973299036*^9, 3.69456999192303*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"HIntegrandOddPart1x", "=", "Hpart2"}], "\[IndentingNewLine]", 
 RowBox[{"HIntegrandOddPart2x", "=", 
  RowBox[{"Hpart2", "/.", 
   RowBox[{"x", "\[Rule]", 
    RowBox[{"-", "x"}]}]}]}]}], "Input",
 CellChangeTimes->{{3.6945476161157293`*^9, 3.69454762694715*^9}, {
  3.694547683835441*^9, 3.694547706467255*^9}, {3.69456617424259*^9, 
  3.694566178648652*^9}, {3.69456629375391*^9, 3.694566297417407*^9}, {
  3.6945663967615957`*^9, 3.694566449583737*^9}, {3.6945669190408783`*^9, 
  3.6945669242723513`*^9}, {3.694567457105301*^9, 3.694567475296542*^9}, {
  3.6945676489609537`*^9, 3.69456764904917*^9}, {3.6945676962250957`*^9, 
  3.69456769659412*^9}, {3.69456815551368*^9, 3.694568179537046*^9}, {
  3.694568357985442*^9, 3.694568362529262*^9}, {3.694568618857709*^9, 
  3.694568619777657*^9}, {3.694569236302108*^9, 3.69456923797956*^9}, {
  3.694569660307582*^9, 3.69456966061887*^9}}],

Cell[BoxData[
 RowBox[{"u00", "+", 
  RowBox[{"2", " ", "u10", " ", 
   RowBox[{"Cos", "[", 
    RowBox[{"x", "+", "\[Theta]1"}], "]"}]}], "+", 
  RowBox[{"2", " ", "u20", " ", 
   RowBox[{"Cos", "[", 
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{"x", "+", "\[Theta]1"}], ")"}]}], "]"}]}], "+", 
  RowBox[{"2", " ", "u01", " ", 
   RowBox[{"Cos", "[", 
    RowBox[{"y", "+", "\[Theta]2"}], "]"}]}], "+", 
  RowBox[{"4", " ", "u11", " ", 
   RowBox[{"Cos", "[", 
    RowBox[{"x", "+", "\[Theta]1"}], "]"}], " ", 
   RowBox[{"Cos", "[", 
    RowBox[{"y", "+", "\[Theta]2"}], "]"}]}], "+", 
  RowBox[{"4", " ", "u21", " ", 
   RowBox[{"Cos", "[", 
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{"x", "+", "\[Theta]1"}], ")"}]}], "]"}], " ", 
   RowBox[{"Cos", "[", 
    RowBox[{"y", "+", "\[Theta]2"}], "]"}]}], "+", 
  RowBox[{"2", " ", "u02", " ", 
   RowBox[{"Cos", "[", 
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{"y", "+", "\[Theta]2"}], ")"}]}], "]"}]}], "+", 
  RowBox[{"4", " ", "u12", " ", 
   RowBox[{"Cos", "[", 
    RowBox[{"x", "+", "\[Theta]1"}], "]"}], " ", 
   RowBox[{"Cos", "[", 
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{"y", "+", "\[Theta]2"}], ")"}]}], "]"}]}]}]], "Output",
 CellChangeTimes->{
  3.694568620423225*^9, 3.694569238284566*^9, 3.694569661351302*^9, 
   3.694570173785193*^9, 3.694570247706135*^9, 3.694576792187002*^9, 
   3.694576902516358*^9, 3.6945885595208673`*^9, 3.694588944270938*^9, 
   3.6945891785826387`*^9, 3.694589302074112*^9, 3.6945893941530952`*^9, 
   3.694589476462838*^9, 3.694716056114315*^9, 3.694785645676229*^9, 
   3.6947984835680227`*^9, 3.6948013877813377`*^9, 3.694803179836411*^9, 
   3.6948032872255363`*^9, 3.694803591042925*^9, {3.694806218595141*^9, 
   3.694806223680977*^9}, 3.694806312042528*^9, 3.694807105063246*^9, 
   3.694807145838655*^9, 3.6948072080911703`*^9, {3.694819944792403*^9, 
   3.694819963129467*^9}, 3.695146504845406*^9}],

Cell[BoxData[
 RowBox[{"u00", "+", 
  RowBox[{"2", " ", "u10", " ", 
   RowBox[{"Cos", "[", 
    RowBox[{"x", "-", "\[Theta]1"}], "]"}]}], "+", 
  RowBox[{"2", " ", "u20", " ", 
   RowBox[{"Cos", "[", 
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "x"}], "+", "\[Theta]1"}], ")"}]}], "]"}]}], "+", 
  RowBox[{"2", " ", "u01", " ", 
   RowBox[{"Cos", "[", 
    RowBox[{"y", "+", "\[Theta]2"}], "]"}]}], "+", 
  RowBox[{"4", " ", "u11", " ", 
   RowBox[{"Cos", "[", 
    RowBox[{"x", "-", "\[Theta]1"}], "]"}], " ", 
   RowBox[{"Cos", "[", 
    RowBox[{"y", "+", "\[Theta]2"}], "]"}]}], "+", 
  RowBox[{"4", " ", "u21", " ", 
   RowBox[{"Cos", "[", 
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "x"}], "+", "\[Theta]1"}], ")"}]}], "]"}], " ", 
   RowBox[{"Cos", "[", 
    RowBox[{"y", "+", "\[Theta]2"}], "]"}]}], "+", 
  RowBox[{"2", " ", "u02", " ", 
   RowBox[{"Cos", "[", 
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{"y", "+", "\[Theta]2"}], ")"}]}], "]"}]}], "+", 
  RowBox[{"4", " ", "u12", " ", 
   RowBox[{"Cos", "[", 
    RowBox[{"x", "-", "\[Theta]1"}], "]"}], " ", 
   RowBox[{"Cos", "[", 
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{"y", "+", "\[Theta]2"}], ")"}]}], "]"}]}]}]], "Output",
 CellChangeTimes->{
  3.694568620423225*^9, 3.694569238284566*^9, 3.694569661351302*^9, 
   3.694570173785193*^9, 3.694570247706135*^9, 3.694576792187002*^9, 
   3.694576902516358*^9, 3.6945885595208673`*^9, 3.694588944270938*^9, 
   3.6945891785826387`*^9, 3.694589302074112*^9, 3.6945893941530952`*^9, 
   3.694589476462838*^9, 3.694716056114315*^9, 3.694785645676229*^9, 
   3.6947984835680227`*^9, 3.6948013877813377`*^9, 3.694803179836411*^9, 
   3.6948032872255363`*^9, 3.694803591042925*^9, {3.694806218595141*^9, 
   3.694806223680977*^9}, 3.694806312042528*^9, 3.694807105063246*^9, 
   3.694807145838655*^9, 3.6948072080911703`*^9, {3.694819944792403*^9, 
   3.694819963129467*^9}, 3.6951465048464746`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"HIntegrand", "[", 
    RowBox[{"x", ",", "y", ",", "\[Theta]1", ",", "\[Theta]2"}], "]"}], ":=", 
   
   RowBox[{
    RowBox[{"-", 
     RowBox[{"Sin", "[", "x", "]"}]}], " ", 
    RowBox[{"(", 
     RowBox[{
      SubscriptBox["u", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "0"}], "}"}]], "+", 
      SubscriptBox["u", 
       RowBox[{"{", 
        RowBox[{"1", ",", "0"}], "}"}]], "+", 
      RowBox[{
       RowBox[{"Cos", "[", "y", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["u", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", 
            RowBox[{"-", "1"}]}], "}"}]], "+", 
         SubscriptBox["u", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "1"}], "}"}]], "+", 
         SubscriptBox["u", 
          RowBox[{"{", 
           RowBox[{"1", ",", 
            RowBox[{"-", "1"}]}], "}"}]], "+", 
         SubscriptBox["u", 
          RowBox[{"{", 
           RowBox[{"1", ",", "1"}], "}"}]]}], ")"}]}], "+", 
      RowBox[{"4", " ", 
       RowBox[{"Cos", "[", "x", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["u", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "2"}], ",", "0"}], "}"}]], "+", 
         SubscriptBox["u", 
          RowBox[{"{", 
           RowBox[{"2", ",", "0"}], "}"}]]}], ")"}]}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"Cos", "[", 
        RowBox[{"x", "+", "\[Theta]1"}], "]"}], " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"y", "+", "\[Theta]2"}], "]"}], " ", 
       SubscriptBox["u", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", 
          RowBox[{"-", "1"}]}], "}"}]]}], "+", 
      RowBox[{
       RowBox[{"Cos", "[", 
        RowBox[{"x", "+", "\[Theta]1"}], "]"}], " ", 
       SubscriptBox["u", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "0"}], "}"}]]}], "+", 
      RowBox[{
       RowBox[{"Cos", "[", 
        RowBox[{"x", "+", "\[Theta]1"}], "]"}], " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"y", "+", "\[Theta]2"}], "]"}], " ", 
       SubscriptBox["u", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "1"}], "}"}]]}], "+", 
      RowBox[{
       RowBox[{"Cos", "[", 
        RowBox[{"y", "+", "\[Theta]2"}], "]"}], " ", 
       SubscriptBox["u", 
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{"-", "1"}]}], "}"}]]}], "+", 
      SubscriptBox["u", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}]], "+", 
      RowBox[{
       RowBox[{"Cos", "[", 
        RowBox[{"y", "+", "\[Theta]2"}], "]"}], " ", 
       SubscriptBox["u", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1"}], "}"}]]}], "+", 
      RowBox[{
       RowBox[{"Cos", "[", 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{"y", "+", "\[Theta]2"}], ")"}]}], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["u", 
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{"-", "2"}]}], "}"}]], "+", 
         SubscriptBox["u", 
          RowBox[{"{", 
           RowBox[{"0", ",", "2"}], "}"}]]}], ")"}]}], "+", 
      RowBox[{
       RowBox[{"Cos", "[", 
        RowBox[{"x", "+", "\[Theta]1"}], "]"}], " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"y", "+", "\[Theta]2"}], "]"}], " ", 
       SubscriptBox["u", 
        RowBox[{"{", 
         RowBox[{"1", ",", 
          RowBox[{"-", "1"}]}], "}"}]]}], "+", 
      RowBox[{
       RowBox[{"Cos", "[", 
        RowBox[{"x", "+", "\[Theta]1"}], "]"}], " ", 
       SubscriptBox["u", 
        RowBox[{"{", 
         RowBox[{"1", ",", "0"}], "}"}]]}], "+", 
      RowBox[{
       RowBox[{"Cos", "[", 
        RowBox[{"x", "+", "\[Theta]1"}], "]"}], " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"y", "+", "\[Theta]2"}], "]"}], " ", 
       SubscriptBox["u", 
        RowBox[{"{", 
         RowBox[{"1", ",", "1"}], "}"}]]}], "+", 
      RowBox[{
       RowBox[{"Cos", "[", 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{"x", "+", "\[Theta]1"}], ")"}]}], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["u", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "2"}], ",", "0"}], "}"}]], "+", 
         SubscriptBox["u", 
          RowBox[{"{", 
           RowBox[{"2", ",", "0"}], "}"}]]}], ")"}]}]}], ")"}]}]}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.6944659060425386`*^9, 3.694465935670126*^9}, {
  3.694547711507289*^9, 3.694547713203195*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"oddpartx", "=", 
  RowBox[{"TrigExpand", "[", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"HIntegrandOddPart1x", "-", "HIntegrandOddPart2x"}], ")"}], "/", 
    "2"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"oddparty", "=", 
  RowBox[{
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"oddpartx", "+", 
       RowBox[{"{", 
        RowBox[{"oddpartx", "/.", 
         RowBox[{"y", "\[Rule]", 
          RowBox[{"-", "y"}]}]}], "}"}]}], ")"}], "/", "2"}], "]"}], "[", 
   RowBox[{"[", "1", "]"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.694465939897472*^9, 3.694465972219993*^9}, {
   3.694466074900412*^9, 3.694466098916909*^9}, {3.694466158924613*^9, 
   3.694466158988391*^9}, {3.694466199213176*^9, 3.6944662031085453`*^9}, {
   3.694466269316619*^9, 3.694466273452441*^9}, {3.694466488540893*^9, 
   3.6944664895087547`*^9}, {3.694547716011055*^9, 3.694547724187004*^9}, {
   3.694566429471506*^9, 3.6945664538311987`*^9}, {3.694566604087697*^9, 
   3.694566660415559*^9}, 3.694566743696125*^9, {3.6945669295363913`*^9, 
   3.694567002840281*^9}, 3.6945671075530453`*^9, {3.694567479353044*^9, 
   3.694567503992813*^9}, {3.694568168784971*^9, 3.694568191505355*^9}, {
   3.694568393977501*^9, 3.694568438283371*^9}, {3.69456848038618*^9, 
   3.694568480561536*^9}, {3.69456968156406*^9, 3.694569691502499*^9}, {
   3.694569738603312*^9, 3.694569774706772*^9}, {3.6945698756270943`*^9, 
   3.694569879283128*^9}, {3.694569950068383*^9, 3.694569950299739*^9}, {
   3.694625946488562*^9, 3.694625950807866*^9}, {3.694701950122508*^9, 
   3.694701976605679*^9}, {3.6948044610735807`*^9, 3.694804462829905*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "2"}], " ", "u10", " ", 
   RowBox[{"Sin", "[", "x", "]"}], " ", 
   RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], "-", 
  RowBox[{"8", " ", "u20", " ", 
   RowBox[{"Cos", "[", "x", "]"}], " ", 
   RowBox[{"Cos", "[", "\[Theta]1", "]"}], " ", 
   RowBox[{"Sin", "[", "x", "]"}], " ", 
   RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], "-", 
  RowBox[{"4", " ", "u11", " ", 
   RowBox[{"Cos", "[", "y", "]"}], " ", 
   RowBox[{"Cos", "[", "\[Theta]2", "]"}], " ", 
   RowBox[{"Sin", "[", "x", "]"}], " ", 
   RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], "-", 
  RowBox[{"16", " ", "u21", " ", 
   RowBox[{"Cos", "[", "x", "]"}], " ", 
   RowBox[{"Cos", "[", "y", "]"}], " ", 
   RowBox[{"Cos", "[", "\[Theta]1", "]"}], " ", 
   RowBox[{"Cos", "[", "\[Theta]2", "]"}], " ", 
   RowBox[{"Sin", "[", "x", "]"}], " ", 
   RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], "-", 
  RowBox[{"4", " ", "u12", " ", 
   SuperscriptBox[
    RowBox[{"Cos", "[", "y", "]"}], "2"], " ", 
   SuperscriptBox[
    RowBox[{"Cos", "[", "\[Theta]2", "]"}], "2"], " ", 
   RowBox[{"Sin", "[", "x", "]"}], " ", 
   RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], "+", 
  RowBox[{"4", " ", "u12", " ", 
   SuperscriptBox[
    RowBox[{"Cos", "[", "\[Theta]2", "]"}], "2"], " ", 
   RowBox[{"Sin", "[", "x", "]"}], " ", 
   SuperscriptBox[
    RowBox[{"Sin", "[", "y", "]"}], "2"], " ", 
   RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], "+", 
  RowBox[{"4", " ", "u11", " ", 
   RowBox[{"Sin", "[", "x", "]"}], " ", 
   RowBox[{"Sin", "[", "y", "]"}], " ", 
   RowBox[{"Sin", "[", "\[Theta]1", "]"}], " ", 
   RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "+", 
  RowBox[{"16", " ", "u21", " ", 
   RowBox[{"Cos", "[", "x", "]"}], " ", 
   RowBox[{"Cos", "[", "\[Theta]1", "]"}], " ", 
   RowBox[{"Sin", "[", "x", "]"}], " ", 
   RowBox[{"Sin", "[", "y", "]"}], " ", 
   RowBox[{"Sin", "[", "\[Theta]1", "]"}], " ", 
   RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "+", 
  RowBox[{"16", " ", "u12", " ", 
   RowBox[{"Cos", "[", "y", "]"}], " ", 
   RowBox[{"Cos", "[", "\[Theta]2", "]"}], " ", 
   RowBox[{"Sin", "[", "x", "]"}], " ", 
   RowBox[{"Sin", "[", "y", "]"}], " ", 
   RowBox[{"Sin", "[", "\[Theta]1", "]"}], " ", 
   RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "+", 
  RowBox[{"4", " ", "u12", " ", 
   SuperscriptBox[
    RowBox[{"Cos", "[", "y", "]"}], "2"], " ", 
   RowBox[{"Sin", "[", "x", "]"}], " ", 
   RowBox[{"Sin", "[", "\[Theta]1", "]"}], " ", 
   SuperscriptBox[
    RowBox[{"Sin", "[", "\[Theta]2", "]"}], "2"]}], "-", 
  RowBox[{"4", " ", "u12", " ", 
   RowBox[{"Sin", "[", "x", "]"}], " ", 
   SuperscriptBox[
    RowBox[{"Sin", "[", "y", "]"}], "2"], " ", 
   RowBox[{"Sin", "[", "\[Theta]1", "]"}], " ", 
   SuperscriptBox[
    RowBox[{"Sin", "[", "\[Theta]2", "]"}], "2"]}]}]], "Output",
 CellChangeTimes->{
  3.694465957899754*^9, 3.6944660070457697`*^9, 3.694466133497528*^9, 
   3.694466192026339*^9, 3.694466225212659*^9, 3.694466510077804*^9, 
   3.6945480641608753`*^9, 3.694566193590352*^9, 3.694566331271738*^9, 
   3.6945664706111383`*^9, {3.694566619616597*^9, 3.694566634820068*^9}, 
   3.694566673331855*^9, 3.694566764934969*^9, 3.6945669442819977`*^9, {
   3.69456698953049*^9, 3.694567005253344*^9}, 3.694567428678046*^9, {
   3.694567484195301*^9, 3.694567505837821*^9}, 3.694567557491293*^9, 
   3.6945676515841227`*^9, 3.694567709285409*^9, 3.6945680437203827`*^9, 
   3.694568158429394*^9, 3.694568196378648*^9, {3.6945684327227573`*^9, 
   3.6945684384642*^9}, 3.694568481324085*^9, 3.6945692407349358`*^9, {
   3.694569745188176*^9, 3.694569775222005*^9}, 3.694569879900462*^9, 
   3.6945699510207033`*^9, 3.694570173885002*^9, 3.694570247899618*^9, 
   3.69457679236444*^9, 3.694576902813984*^9, 3.694588561090026*^9, 
   3.69458894444401*^9, 3.694589180034103*^9, 3.694589302234086*^9, 
   3.694589394318124*^9, 3.694589477925123*^9, 3.6946259516292143`*^9, {
   3.694701951150689*^9, 3.694701976911483*^9}, 3.694716056310701*^9, 
   3.694785645730048*^9, 3.694798483634297*^9, 3.6948013878669977`*^9, 
   3.6948031798749743`*^9, 3.694803287271078*^9, 3.694803591095133*^9, 
   3.694804463249021*^9, {3.694806218621769*^9, 3.694806223711464*^9}, 
   3.6948063120936317`*^9, 3.694807105135895*^9, 3.694807145895783*^9, 
   3.6948072081469793`*^9, {3.6948199449514303`*^9, 3.69481996331364*^9}, 
   3.695146505005034*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "2"}], " ", 
  RowBox[{"(", 
   RowBox[{"u10", "+", 
    RowBox[{"2", " ", "u11", " ", 
     RowBox[{"Cos", "[", "y", "]"}], " ", 
     RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
    RowBox[{"4", " ", 
     RowBox[{"Cos", "[", "x", "]"}], " ", 
     RowBox[{"Cos", "[", "\[Theta]1", "]"}], " ", 
     RowBox[{"(", 
      RowBox[{"u20", "+", 
       RowBox[{"2", " ", "u21", " ", 
        RowBox[{"Cos", "[", "y", "]"}], " ", 
        RowBox[{"Cos", "[", "\[Theta]2", "]"}]}]}], ")"}]}], "+", 
    RowBox[{"2", " ", "u12", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"2", " ", "y"}], "]"}], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"2", " ", "\[Theta]2"}], "]"}]}]}], ")"}], " ", 
  RowBox[{"Sin", "[", "x", "]"}], " ", 
  RowBox[{"Sin", "[", "\[Theta]1", "]"}]}]], "Output",
 CellChangeTimes->{
  3.694465957899754*^9, 3.6944660070457697`*^9, 3.694466133497528*^9, 
   3.694466192026339*^9, 3.694466225212659*^9, 3.694466510077804*^9, 
   3.6945480641608753`*^9, 3.694566193590352*^9, 3.694566331271738*^9, 
   3.6945664706111383`*^9, {3.694566619616597*^9, 3.694566634820068*^9}, 
   3.694566673331855*^9, 3.694566764934969*^9, 3.6945669442819977`*^9, {
   3.69456698953049*^9, 3.694567005253344*^9}, 3.694567428678046*^9, {
   3.694567484195301*^9, 3.694567505837821*^9}, 3.694567557491293*^9, 
   3.6945676515841227`*^9, 3.694567709285409*^9, 3.6945680437203827`*^9, 
   3.694568158429394*^9, 3.694568196378648*^9, {3.6945684327227573`*^9, 
   3.6945684384642*^9}, 3.694568481324085*^9, 3.6945692407349358`*^9, {
   3.694569745188176*^9, 3.694569775222005*^9}, 3.694569879900462*^9, 
   3.6945699510207033`*^9, 3.694570173885002*^9, 3.694570247899618*^9, 
   3.69457679236444*^9, 3.694576902813984*^9, 3.694588561090026*^9, 
   3.69458894444401*^9, 3.694589180034103*^9, 3.694589302234086*^9, 
   3.694589394318124*^9, 3.694589477925123*^9, 3.6946259516292143`*^9, {
   3.694701951150689*^9, 3.694701976911483*^9}, 3.694716056310701*^9, 
   3.694785645730048*^9, 3.694798483634297*^9, 3.6948013878669977`*^9, 
   3.6948031798749743`*^9, 3.694803287271078*^9, 3.694803591095133*^9, 
   3.694804463249021*^9, {3.694806218621769*^9, 3.694806223711464*^9}, 
   3.6948063120936317`*^9, 3.694807105135895*^9, 3.694807145895783*^9, 
   3.6948072081469793`*^9, {3.6948199449514303`*^9, 3.69481996331364*^9}, 
   3.695146505692203*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"Collect", "[", 
    RowBox[{
     RowBox[{"Expand", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Sin", "[", "x", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          SubscriptBox["u", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "0"}], "}"}]], "+", 
          SubscriptBox["u", 
           RowBox[{"{", 
            RowBox[{"1", ",", "0"}], "}"}]], "+", 
          RowBox[{
           RowBox[{"Cos", "[", "y", "]"}], " ", 
           RowBox[{"(", 
            RowBox[{
             SubscriptBox["u", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "1"}], ",", 
                RowBox[{"-", "1"}]}], "}"}]], "+", 
             SubscriptBox["u", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "1"}], ",", "1"}], "}"}]], "+", 
             SubscriptBox["u", 
              RowBox[{"{", 
               RowBox[{"1", ",", 
                RowBox[{"-", "1"}]}], "}"}]], "+", 
             SubscriptBox["u", 
              RowBox[{"{", 
               RowBox[{"1", ",", "1"}], "}"}]]}], ")"}]}], "+", 
          RowBox[{"4", " ", 
           RowBox[{"Cos", "[", "x", "]"}], " ", 
           RowBox[{"(", 
            RowBox[{
             SubscriptBox["u", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "2"}], ",", "0"}], "}"}]], "+", 
             SubscriptBox["u", 
              RowBox[{"{", 
               RowBox[{"2", ",", "0"}], "}"}]]}], ")"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"Cos", "[", "y", "]"}], " ", 
              RowBox[{"Cos", "[", "\[Theta]2", "]"}], " ", 
              RowBox[{"Sin", "[", "x", "]"}], " ", 
              RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], "+", 
             RowBox[{
              RowBox[{"Cos", "[", "x", "]"}], " ", 
              RowBox[{"Cos", "[", "\[Theta]1", "]"}], " ", 
              RowBox[{"Sin", "[", "y", "]"}], " ", 
              RowBox[{"Sin", "[", "\[Theta]2", "]"}]}]}], ")"}], " ", 
           SubscriptBox["u", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "1"}], ",", 
              RowBox[{"-", "1"}]}], "}"}]]}], "+", 
          RowBox[{
           RowBox[{"Sin", "[", "x", "]"}], " ", 
           RowBox[{"Sin", "[", "\[Theta]1", "]"}], " ", 
           SubscriptBox["u", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "1"}], ",", "0"}], "}"}]]}], "+", 
          RowBox[{
           RowBox[{"Cos", "[", "y", "]"}], " ", 
           RowBox[{"Cos", "[", "\[Theta]2", "]"}], " ", 
           RowBox[{"Sin", "[", "x", "]"}], " ", 
           RowBox[{"Sin", "[", "\[Theta]1", "]"}], " ", 
           SubscriptBox["u", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "1"}], ",", "1"}], "}"}]]}], "+", 
          RowBox[{
           RowBox[{"Cos", "[", "x", "]"}], " ", 
           RowBox[{"Cos", "[", "\[Theta]1", "]"}], " ", 
           RowBox[{"Sin", "[", "y", "]"}], " ", 
           RowBox[{"Sin", "[", "\[Theta]2", "]"}], " ", 
           SubscriptBox["u", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "1"}], ",", "1"}], "}"}]]}], "+", 
          RowBox[{
           RowBox[{"Sin", "[", "y", "]"}], " ", 
           RowBox[{"Sin", "[", "\[Theta]2", "]"}], " ", 
           SubscriptBox["u", 
            RowBox[{"{", 
             RowBox[{"0", ",", 
              RowBox[{"-", "1"}]}], "}"}]]}], "+", 
          RowBox[{
           RowBox[{"Sin", "[", "y", "]"}], " ", 
           RowBox[{"Sin", "[", "\[Theta]2", "]"}], " ", 
           SubscriptBox["u", 
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}]]}], "+", 
          RowBox[{
           RowBox[{"Sin", "[", 
            RowBox[{"2", " ", "y"}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"2", " ", "\[Theta]2"}], "]"}], " ", 
           RowBox[{"(", 
            RowBox[{
             SubscriptBox["u", 
              RowBox[{"{", 
               RowBox[{"0", ",", 
                RowBox[{"-", "2"}]}], "}"}]], "+", 
             SubscriptBox["u", 
              RowBox[{"{", 
               RowBox[{"0", ",", "2"}], "}"}]]}], ")"}]}], "+", 
          RowBox[{
           RowBox[{"Cos", "[", "y", "]"}], " ", 
           RowBox[{"Cos", "[", "\[Theta]2", "]"}], " ", 
           RowBox[{"Sin", "[", "x", "]"}], " ", 
           RowBox[{"Sin", "[", "\[Theta]1", "]"}], " ", 
           SubscriptBox["u", 
            RowBox[{"{", 
             RowBox[{"1", ",", 
              RowBox[{"-", "1"}]}], "}"}]]}], "+", 
          RowBox[{
           RowBox[{"Cos", "[", "x", "]"}], " ", 
           RowBox[{"Cos", "[", "\[Theta]1", "]"}], " ", 
           RowBox[{"Sin", "[", "y", "]"}], " ", 
           RowBox[{"Sin", "[", "\[Theta]2", "]"}], " ", 
           SubscriptBox["u", 
            RowBox[{"{", 
             RowBox[{"1", ",", 
              RowBox[{"-", "1"}]}], "}"}]]}], "+", 
          RowBox[{
           RowBox[{"Sin", "[", "x", "]"}], " ", 
           RowBox[{"Sin", "[", "\[Theta]1", "]"}], " ", 
           SubscriptBox["u", 
            RowBox[{"{", 
             RowBox[{"1", ",", "0"}], "}"}]]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"Cos", "[", "y", "]"}], " ", 
              RowBox[{"Cos", "[", "\[Theta]2", "]"}], " ", 
              RowBox[{"Sin", "[", "x", "]"}], " ", 
              RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], "+", 
             RowBox[{
              RowBox[{"Cos", "[", "x", "]"}], " ", 
              RowBox[{"Cos", "[", "\[Theta]1", "]"}], " ", 
              RowBox[{"Sin", "[", "y", "]"}], " ", 
              RowBox[{"Sin", "[", "\[Theta]2", "]"}]}]}], ")"}], " ", 
           SubscriptBox["u", 
            RowBox[{"{", 
             RowBox[{"1", ",", "1"}], "}"}]]}], "+", 
          RowBox[{
           RowBox[{"Sin", "[", 
            RowBox[{"2", " ", "x"}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"2", " ", "\[Theta]1"}], "]"}], " ", 
           RowBox[{"(", 
            RowBox[{
             SubscriptBox["u", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "2"}], ",", "0"}], "}"}]], "+", 
             SubscriptBox["u", 
              RowBox[{"{", 
               RowBox[{"2", ",", "0"}], "}"}]]}], ")"}]}]}], ")"}]}], "}"}], 
      "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Cos", "[", "\[Theta]1", "]"}], ",", 
       RowBox[{"Sin", "[", 
        RowBox[{"2", "\[Theta]2"}], "]"}], ",", 
       RowBox[{"Sin", "[", "\[Theta]2", "]"}], ",", 
       RowBox[{"Cos", "[", "\[Theta]2", "]"}], ",", 
       RowBox[{"Sin", "[", 
        RowBox[{"2", "\[Theta]1"}], "]"}], ",", 
       RowBox[{"Sin", "[", "\[Theta]1", "]"}], ",", 
       RowBox[{
        RowBox[{"Sin", "[", "\[Theta]1", "]"}], 
        RowBox[{"Cos", "[", "\[Theta]2", "]"}]}]}], "}"}]}], "]"}], " ", 
   ";"}], "*)"}]], "Input",
 CellChangeTimes->{{3.694466277705159*^9, 3.694466279053101*^9}, {
  3.694466559816581*^9, 3.694466601357758*^9}, {3.694466640829773*^9, 
  3.6944666554692574`*^9}, {3.694467876343553*^9, 3.6944679563110647`*^9}, {
  3.694542449565975*^9, 3.694542453204811*^9}, {3.6945424855436*^9, 
  3.69454249611802*^9}, {3.694542784973816*^9, 3.694542793118764*^9}}],

Cell[TextData[{
 "From data we know that (0,+/-1) and (+/-1,0) have the same coefficients, as \
well as the set of (+/-1,+/-1), and the set of (0,+/-2),(+/-2,0). So we make \
the following notational changes. ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["u", "00"], "=", 
    SubscriptBox["u", "0"]}], TraditionalForm]]],
 ", ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["u", 
     RowBox[{"0", "\[PlusMinus]", "1"}]], "=", 
    RowBox[{
     SubscriptBox["u", 
      RowBox[{"\[PlusMinus]", "10"}]], "=", 
     SubscriptBox["u", "1"]}]}], TraditionalForm]]],
 ", ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["u", 
     RowBox[{
      RowBox[{"\[PlusMinus]", "1"}], "\[PlusMinus]", "1"}]], "=", 
    SubscriptBox["u", "2"]}], TraditionalForm]]],
 ", and ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["u", 
     RowBox[{"\[PlusMinus]", "20"}]], "=", 
    RowBox[{
     SubscriptBox["u", 
      RowBox[{"0", "\[PlusMinus]", "2"}]], "=", 
     SubscriptBox["u", "3"]}]}], TraditionalForm]]],
 ". So the above command may be rewritten as"
}], "Text",
 CellChangeTimes->{{3.694542498804927*^9, 3.694542782509386*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"hfun", "=", 
  RowBox[{"Collect", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"TrigExpand", "[", 
        RowBox[{"Hpart1", " ", "oddparty"}], "]"}], "/.", 
       RowBox[{"u01", "\[Rule]", "u10"}]}], "/.", 
      RowBox[{"u12", "\[Rule]", "u21"}]}], "/.", 
     RowBox[{"u02", "\[Rule]", "u20"}]}], ",", 
    RowBox[{"Flatten", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Outer", "[", 
        RowBox[{"Times", ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", 
           RowBox[{
            RowBox[{"Sin", "[", "x", "]"}], "^", "_."}], ",", 
           RowBox[{
            RowBox[{"Sin", "[", "y", "]"}], "^", "_."}], ",", 
           RowBox[{
            RowBox[{"Cos", "[", "x", "]"}], "^", "_."}], ",", 
           RowBox[{
            RowBox[{"Cos", "[", "y", "]"}], "^", "_."}], ",", 
           RowBox[{"Sin", "[", "x", "]"}], ",", 
           RowBox[{"Sin", "[", "y", "]"}], ",", 
           RowBox[{"Cos", "[", "x", "]"}], ",", 
           RowBox[{"Cos", "[", "y", "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"Sin", "[", "x", "]"}], "^", "_."}], ",", 
           RowBox[{
            RowBox[{"Sin", "[", "y", "]"}], "^", "_."}], ",", 
           RowBox[{
            RowBox[{"Cos", "[", "x", "]"}], "^", "_."}], ",", 
           RowBox[{
            RowBox[{"Cos", "[", "y", "]"}], "^", "_."}], ",", 
           RowBox[{"Sin", "[", "x", "]"}], ",", 
           RowBox[{"Sin", "[", "y", "]"}], ",", 
           RowBox[{"Cos", "[", "x", "]"}], ",", 
           RowBox[{"Cos", "[", "y", "]"}]}], "}"}]}], "]"}], "/.", 
       RowBox[{"x", "\[Rule]", "\[Theta]1"}]}], "/.", 
      RowBox[{"y", "\[Rule]", "\[Theta]2"}]}], "]"}], ",", "FullSimplify"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"hfun", "=", 
     RowBox[{"Collect", "[", 
      RowBox[{"v1", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"Sin", "[", "\[Theta]1", "]"}], 
          SuperscriptBox[
           RowBox[{"Cos", "[", "\[Theta]2", "]"}], "2"]}], ",", 
         RowBox[{
          RowBox[{"Sin", "[", "\[Theta]1", "]"}], 
          SuperscriptBox[
           RowBox[{"Sin", "[", "\[Theta]2", "]"}], "2"]}], ",", 
         RowBox[{"Sin", "[", "\[Theta]1", "]"}], ",", 
         RowBox[{
          RowBox[{"Cos", "[", "\[Theta]1", "]"}], 
          RowBox[{"Sin", "[", "\[Theta]1", "]"}], 
          RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], ",", 
         RowBox[{
          RowBox[{"Sin", "[", "\[Theta]1", "]"}], 
          RowBox[{"Cos", "[", "\[Theta]1", "]"}]}], ",", 
         RowBox[{
          RowBox[{"Sin", "[", "\[Theta]1", "]"}], 
          RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], ",", 
         RowBox[{
          RowBox[{"Sin", "[", "\[Theta]1", "]"}], 
          RowBox[{"Sin", "[", "\[Theta]2", "]"}]}]}], "}"}]}], "]"}]}], ";"}],
    "*)"}]}]}], "Input",
 CellChangeTimes->{{3.6945428036916447`*^9, 3.694542954773711*^9}, 
   3.69454336607903*^9, {3.694543416566753*^9, 3.694543418614318*^9}, {
   3.694548112655704*^9, 3.694548244948112*^9}, {3.694548392813212*^9, 
   3.694548761636572*^9}, {3.694548813381567*^9, 3.694548878236342*^9}, {
   3.694548909821144*^9, 3.694548966468445*^9}, {3.694561991571509*^9, 
   3.6945620847560453`*^9}, {3.6945663443154173`*^9, 3.69456635043194*^9}, 
   3.694566479323251*^9, {3.6945670650914*^9, 3.694567273481187*^9}, 
   3.694567324794198*^9, {3.694567512617228*^9, 3.694567537184506*^9}, 
   3.694567668726473*^9, {3.6945680638176813`*^9, 3.694568072922036*^9}, {
   3.694568205497382*^9, 3.694568238041782*^9}, 3.694568320873982*^9, {
   3.694568444177554*^9, 3.694568448313861*^9}, {3.694568485009975*^9, 
   3.694568492457945*^9}, 3.694569754974903*^9, {3.694570184195526*^9, 
   3.694570188207438*^9}, {3.6945702568356524`*^9, 3.6945702791235237`*^9}, {
   3.694576980587829*^9, 3.694577021532557*^9}, {3.694577056659696*^9, 
   3.694577058115172*^9}, {3.694578200644415*^9, 3.694578238835887*^9}, {
   3.694588572444454*^9, 3.69458859967925*^9}, {3.694588632519834*^9, 
   3.694588777135786*^9}, {3.6945888107435017`*^9, 3.69458884177563*^9}, {
   3.6945890230690613`*^9, 3.694589072127665*^9}, {3.694589193736182*^9, 
   3.694589261111964*^9}, {3.694589507354557*^9, 3.694589695712535*^9}, {
   3.694589736528833*^9, 3.694589752257348*^9}, {3.6947972305264807`*^9, 
   3.694797266166078*^9}, {3.6947973669754057`*^9, 3.694797369007484*^9}, {
   3.694797997759161*^9, 3.694798120031248*^9}, {3.6947981620231457`*^9, 
   3.6947981837911263`*^9}, {3.694798216967309*^9, 3.69479821979156*^9}, {
   3.694798313208211*^9, 3.694798317239222*^9}, {3.6947984100395193`*^9, 
   3.69479843451254*^9}, {3.6947985344953947`*^9, 3.694798589871593*^9}, 
   3.694799577152899*^9, {3.694799610008752*^9, 3.6947997093928022`*^9}, {
   3.6948003967859993`*^9, 3.694800398833427*^9}, {3.694800942948742*^9, 
   3.6948009888664*^9}, {3.694801068706815*^9, 3.6948010725868807`*^9}, {
   3.6948011155231533`*^9, 3.6948011158504677`*^9}, {3.694801184723385*^9, 
   3.6948011974666*^9}, {3.6948012600987797`*^9, 3.69480130909863*^9}, {
   3.694801352458641*^9, 3.6948013549786043`*^9}, {3.694804178390327*^9, 
   3.6948041788457727`*^9}, {3.694804399062277*^9, 3.694804425671472*^9}, {
   3.6948044676386023`*^9, 3.694804468662129*^9}, {3.694804576950841*^9, 
   3.69480460693406*^9}, 3.694804675023135*^9, 3.694804759799283*^9, {
   3.694806449385324*^9, 3.6948064499361773`*^9}, 3.6948200139832897`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"4", " ", "u10", " ", 
   RowBox[{"(", 
    RowBox[{"u10", "+", 
     RowBox[{"2", " ", "u11", " ", 
      RowBox[{"Cos", "[", "y", "]"}]}], "+", 
     RowBox[{"4", " ", 
      RowBox[{"Cos", "[", "x", "]"}], " ", 
      RowBox[{"(", 
       RowBox[{"u20", "+", 
        RowBox[{"2", " ", "u21", " ", 
         RowBox[{"Cos", "[", "y", "]"}]}]}], ")"}]}], "+", 
     RowBox[{"2", " ", "u21", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"2", " ", "y"}], "]"}]}]}], ")"}], " ", 
   SuperscriptBox[
    RowBox[{"Sin", "[", "x", "]"}], "2"], " ", 
   RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], "+", 
  RowBox[{"16", " ", "u20", " ", 
   RowBox[{"Cos", "[", "x", "]"}], " ", 
   RowBox[{"(", 
    RowBox[{"u10", "+", 
     RowBox[{"2", " ", "u11", " ", 
      RowBox[{"Cos", "[", "y", "]"}]}], "+", 
     RowBox[{"4", " ", 
      RowBox[{"Cos", "[", "x", "]"}], " ", 
      RowBox[{"(", 
       RowBox[{"u20", "+", 
        RowBox[{"2", " ", "u21", " ", 
         RowBox[{"Cos", "[", "y", "]"}]}]}], ")"}]}], "+", 
     RowBox[{"2", " ", "u21", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"2", " ", "y"}], "]"}]}]}], ")"}], " ", 
   RowBox[{"Cos", "[", "\[Theta]1", "]"}], " ", 
   SuperscriptBox[
    RowBox[{"Sin", "[", "x", "]"}], "2"], " ", 
   RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], "+", 
  RowBox[{"8", " ", "u11", " ", 
   RowBox[{"Cos", "[", "y", "]"}], " ", 
   RowBox[{"(", 
    RowBox[{"u10", "+", 
     RowBox[{"2", " ", "u11", " ", 
      RowBox[{"Cos", "[", "y", "]"}]}], "+", 
     RowBox[{"4", " ", 
      RowBox[{"Cos", "[", "x", "]"}], " ", 
      RowBox[{"(", 
       RowBox[{"u20", "+", 
        RowBox[{"2", " ", "u21", " ", 
         RowBox[{"Cos", "[", "y", "]"}]}]}], ")"}]}], "+", 
     RowBox[{"2", " ", "u21", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"2", " ", "y"}], "]"}]}]}], ")"}], " ", 
   RowBox[{"Cos", "[", "\[Theta]2", "]"}], " ", 
   SuperscriptBox[
    RowBox[{"Sin", "[", "x", "]"}], "2"], " ", 
   RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], "+", 
  RowBox[{"32", " ", "u21", " ", 
   RowBox[{"Cos", "[", "x", "]"}], " ", 
   RowBox[{"Cos", "[", "y", "]"}], " ", 
   RowBox[{"(", 
    RowBox[{"u10", "+", 
     RowBox[{"2", " ", "u11", " ", 
      RowBox[{"Cos", "[", "y", "]"}]}], "+", 
     RowBox[{"4", " ", 
      RowBox[{"Cos", "[", "x", "]"}], " ", 
      RowBox[{"(", 
       RowBox[{"u20", "+", 
        RowBox[{"2", " ", "u21", " ", 
         RowBox[{"Cos", "[", "y", "]"}]}]}], ")"}]}], "+", 
     RowBox[{"2", " ", "u21", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"2", " ", "y"}], "]"}]}]}], ")"}], " ", 
   RowBox[{"Cos", "[", "\[Theta]1", "]"}], " ", 
   RowBox[{"Cos", "[", "\[Theta]2", "]"}], " ", 
   SuperscriptBox[
    RowBox[{"Sin", "[", "x", "]"}], "2"], " ", 
   RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], "+", 
  RowBox[{"8", " ", "u21", " ", 
   RowBox[{"Cos", "[", 
    RowBox[{"2", " ", "y"}], "]"}], " ", 
   RowBox[{"(", 
    RowBox[{"u10", "+", 
     RowBox[{"2", " ", "u11", " ", 
      RowBox[{"Cos", "[", "y", "]"}]}], "+", 
     RowBox[{"4", " ", 
      RowBox[{"Cos", "[", "x", "]"}], " ", 
      RowBox[{"(", 
       RowBox[{"u20", "+", 
        RowBox[{"2", " ", "u21", " ", 
         RowBox[{"Cos", "[", "y", "]"}]}]}], ")"}]}], "+", 
     RowBox[{"2", " ", "u21", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"2", " ", "y"}], "]"}]}]}], ")"}], " ", 
   SuperscriptBox[
    RowBox[{"Cos", "[", "\[Theta]2", "]"}], "2"], " ", 
   SuperscriptBox[
    RowBox[{"Sin", "[", "x", "]"}], "2"], " ", 
   RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], "-", 
  RowBox[{"8", " ", "u21", " ", 
   RowBox[{"Cos", "[", 
    RowBox[{"2", " ", "y"}], "]"}], " ", 
   RowBox[{"(", 
    RowBox[{"u10", "+", 
     RowBox[{"2", " ", "u11", " ", 
      RowBox[{"Cos", "[", "y", "]"}]}], "+", 
     RowBox[{"4", " ", 
      RowBox[{"Cos", "[", "x", "]"}], " ", 
      RowBox[{"(", 
       RowBox[{"u20", "+", 
        RowBox[{"2", " ", "u21", " ", 
         RowBox[{"Cos", "[", "y", "]"}]}]}], ")"}]}], "+", 
     RowBox[{"2", " ", "u21", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"2", " ", "y"}], "]"}]}]}], ")"}], " ", 
   SuperscriptBox[
    RowBox[{"Sin", "[", "x", "]"}], "2"], " ", 
   RowBox[{"Sin", "[", "\[Theta]1", "]"}], " ", 
   SuperscriptBox[
    RowBox[{"Sin", "[", "\[Theta]2", "]"}], "2"]}]}]], "Output",
 CellChangeTimes->{
  3.694804438665881*^9, 3.69480447021776*^9, 3.694804608615328*^9, 
   3.6948046761584*^9, {3.694804756010064*^9, 3.694804761044956*^9}, 
   3.694805164453733*^9, {3.6948062186504383`*^9, 3.694806223850142*^9}, 
   3.694806314167205*^9, 3.694806451969099*^9, 3.694807107445291*^9, 
   3.6948071483247557`*^9, 3.6948072105282507`*^9, {3.694819947381982*^9, 
   3.694819965637044*^9}, 3.6948200158209457`*^9, 3.695146507366444*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"hfun", " ", "//", "FortranForm"}]], "Input",
 CellChangeTimes->{{3.6945782121715*^9, 3.69457824159601*^9}, 
   3.694805154567142*^9}],

Cell["\<\
        4*u10*(u10 + 2*u11*Cos(y) + 4*Cos(x)*(u20 + 2*u21*Cos(y)) + \
2*u21*Cos(2*y))*Sin(x)**2*Sin(\[Theta]1) + 
     -  16*u20*Cos(x)*(u10 + 2*u11*Cos(y) + 4*Cos(x)*(u20 + 2*u21*Cos(y)) + \
2*u21*Cos(2*y))*Cos(\[Theta]1)*Sin(x)**2*Sin(\[Theta]1) + 
     -  8*u11*Cos(y)*(u10 + 2*u11*Cos(y) + 4*Cos(x)*(u20 + 2*u21*Cos(y)) + \
2*u21*Cos(2*y))*Cos(\[Theta]2)*Sin(x)**2*Sin(\[Theta]1) + 
     -  32*u21*Cos(x)*Cos(y)*(u10 + 2*u11*Cos(y) + 4*Cos(x)*(u20 + \
2*u21*Cos(y)) + 2*u21*Cos(2*y))*Cos(\[Theta]1)*Cos(\[Theta]2)*Sin(x)**2*Sin(\
\[Theta]1) + 
     -  8*u21*Cos(2*y)*(u10 + 2*u11*Cos(y) + 4*Cos(x)*(u20 + 2*u21*Cos(y)) + \
2*u21*Cos(2*y))*Cos(\[Theta]2)**2*Sin(x)**2*Sin(\[Theta]1) - 
     -  8*u21*Cos(2*y)*(u10 + 2*u11*Cos(y) + 4*Cos(x)*(u20 + 2*u21*Cos(y)) + \
2*u21*Cos(2*y))*Sin(x)**2*Sin(\[Theta]1)*Sin(\[Theta]2)**2\
\>", "Output",
 CellChangeTimes->{{3.694578220459736*^9, 3.694578244944306*^9}, 
   3.69458856265664*^9, 3.694588944725155*^9, 3.694589025945093*^9, 
   3.694589181485508*^9, 3.6945893026134*^9, 3.694589479459125*^9, 
   3.694716057978469*^9, 3.6947856472268677`*^9, 3.694798484468701*^9, 
   3.6948013893663483`*^9, 3.694803180304412*^9, 3.694803287693548*^9, 
   3.694803593071*^9, 3.694804333223851*^9, 3.6948046974800034`*^9, {
   3.694805155066249*^9, 3.6948051673611393`*^9}, {3.694806218671913*^9, 
   3.6948062238750973`*^9}, 3.694806314211215*^9, 3.694807107515139*^9, 
   3.694807148402075*^9, 3.694807210612101*^9, {3.694819947554158*^9, 
   3.694819965783145*^9}, 3.694820041347549*^9, 3.69514650752382*^9}]
}, Open  ]],

Cell["\<\
The \[OpenCurlyDoubleQuote]-\[OpenCurlyDoubleQuote] signs preceding each line \
are for Fortran code. We may ignore these. Anyways, what we have are some \
constants multiplying functions of th1 and th2. We copy this equation into \
twod_trunc.py and perform the necessary calculations there.\
\>", "Text",
 CellChangeTimes->{{3.694543341626807*^9, 3.69454337346203*^9}, {
  3.694543422558065*^9, 3.6945435063501987`*^9}, {3.694578195244214*^9, 
  3.694578224027954*^9}}],

Cell["Now we plug in the h function into the integral.", "Text",
 CellChangeTimes->{{3.694804766189796*^9, 3.694804778077972*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"hfunFinal", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"hfun", "/.", 
       RowBox[{
        RowBox[{"Cos", "[", "x", "]"}], "\[Rule]", "hcx"}]}], "/.", 
      RowBox[{
       RowBox[{"Sin", "[", "x", "]"}], "\[Rule]", "hsx"}]}], "/.", 
     RowBox[{
      RowBox[{"Sin", "[", "y", "]"}], "\[Rule]", "hsy"}]}], "/.", 
    RowBox[{
     RowBox[{"Cos", "[", "y", "]"}], "\[Rule]", "hcy"}]}], "/.", 
   RowBox[{
    RowBox[{"Cos", "[", 
     RowBox[{"2", "y"}], "]"}], "\[Rule]", "hc2y"}]}]}]], "Input",
 CellChangeTimes->{{3.6948053267078447`*^9, 3.694805423062942*^9}, {
  3.694805516911154*^9, 3.694805644023609*^9}, {3.694805725895268*^9, 
  3.694805730102995*^9}, {3.6948061431117353`*^9, 3.694806200255905*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"4", " ", 
   SuperscriptBox["hsx", "2"], " ", "u10", " ", 
   RowBox[{"(", 
    RowBox[{"u10", "+", 
     RowBox[{"2", " ", "hcy", " ", "u11"}], "+", 
     RowBox[{"2", " ", "hc2y", " ", "u21"}], "+", 
     RowBox[{"4", " ", "hcx", " ", 
      RowBox[{"(", 
       RowBox[{"u20", "+", 
        RowBox[{"2", " ", "hcy", " ", "u21"}]}], ")"}]}]}], ")"}], " ", 
   RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], "+", 
  RowBox[{"16", " ", "hcx", " ", 
   SuperscriptBox["hsx", "2"], " ", "u20", " ", 
   RowBox[{"(", 
    RowBox[{"u10", "+", 
     RowBox[{"2", " ", "hcy", " ", "u11"}], "+", 
     RowBox[{"2", " ", "hc2y", " ", "u21"}], "+", 
     RowBox[{"4", " ", "hcx", " ", 
      RowBox[{"(", 
       RowBox[{"u20", "+", 
        RowBox[{"2", " ", "hcy", " ", "u21"}]}], ")"}]}]}], ")"}], " ", 
   RowBox[{"Cos", "[", "\[Theta]1", "]"}], " ", 
   RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], "+", 
  RowBox[{"8", " ", "hcy", " ", 
   SuperscriptBox["hsx", "2"], " ", "u11", " ", 
   RowBox[{"(", 
    RowBox[{"u10", "+", 
     RowBox[{"2", " ", "hcy", " ", "u11"}], "+", 
     RowBox[{"2", " ", "hc2y", " ", "u21"}], "+", 
     RowBox[{"4", " ", "hcx", " ", 
      RowBox[{"(", 
       RowBox[{"u20", "+", 
        RowBox[{"2", " ", "hcy", " ", "u21"}]}], ")"}]}]}], ")"}], " ", 
   RowBox[{"Cos", "[", "\[Theta]2", "]"}], " ", 
   RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], "+", 
  RowBox[{"32", " ", "hcx", " ", "hcy", " ", 
   SuperscriptBox["hsx", "2"], " ", "u21", " ", 
   RowBox[{"(", 
    RowBox[{"u10", "+", 
     RowBox[{"2", " ", "hcy", " ", "u11"}], "+", 
     RowBox[{"2", " ", "hc2y", " ", "u21"}], "+", 
     RowBox[{"4", " ", "hcx", " ", 
      RowBox[{"(", 
       RowBox[{"u20", "+", 
        RowBox[{"2", " ", "hcy", " ", "u21"}]}], ")"}]}]}], ")"}], " ", 
   RowBox[{"Cos", "[", "\[Theta]1", "]"}], " ", 
   RowBox[{"Cos", "[", "\[Theta]2", "]"}], " ", 
   RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], "+", 
  RowBox[{"8", " ", "hc2y", " ", 
   SuperscriptBox["hsx", "2"], " ", "u21", " ", 
   RowBox[{"(", 
    RowBox[{"u10", "+", 
     RowBox[{"2", " ", "hcy", " ", "u11"}], "+", 
     RowBox[{"2", " ", "hc2y", " ", "u21"}], "+", 
     RowBox[{"4", " ", "hcx", " ", 
      RowBox[{"(", 
       RowBox[{"u20", "+", 
        RowBox[{"2", " ", "hcy", " ", "u21"}]}], ")"}]}]}], ")"}], " ", 
   SuperscriptBox[
    RowBox[{"Cos", "[", "\[Theta]2", "]"}], "2"], " ", 
   RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], "-", 
  RowBox[{"8", " ", "hc2y", " ", 
   SuperscriptBox["hsx", "2"], " ", "u21", " ", 
   RowBox[{"(", 
    RowBox[{"u10", "+", 
     RowBox[{"2", " ", "hcy", " ", "u11"}], "+", 
     RowBox[{"2", " ", "hc2y", " ", "u21"}], "+", 
     RowBox[{"4", " ", "hcx", " ", 
      RowBox[{"(", 
       RowBox[{"u20", "+", 
        RowBox[{"2", " ", "hcy", " ", "u21"}]}], ")"}]}]}], ")"}], " ", 
   RowBox[{"Sin", "[", "\[Theta]1", "]"}], " ", 
   SuperscriptBox[
    RowBox[{"Sin", "[", "\[Theta]2", "]"}], "2"]}]}]], "Output",
 CellChangeTimes->{{3.6948053449381027`*^9, 3.6948053652262373`*^9}, 
   3.69480543182621*^9, {3.694805518733542*^9, 3.694805644217732*^9}, 
   3.6948057305703087`*^9, {3.694806152326953*^9, 3.694806223899288*^9}, 
   3.694806314259057*^9, {3.694807102240467*^9, 3.69480710755398*^9}, 
   3.694807148442181*^9, 3.694807210651805*^9, {3.694819947647601*^9, 
   3.6948199658738327`*^9}, 3.6948200465336018`*^9, 3.695146507614262*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Collect", "[", 
  RowBox[{
   RowBox[{"TrigExpand", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"hfunFinal", "/.", 
        RowBox[{
         RowBox[{"Cos", "[", "x", "]"}], "\[Rule]", 
         RowBox[{"Inactive", "[", 
          RowBox[{"Cos", "[", "x", "]"}], "]"}]}]}], "/.", 
       RowBox[{
        RowBox[{"Cos", "[", "y", "]"}], "\[Rule]", 
        RowBox[{"Inactive", "[", 
         RowBox[{"Cos", "[", "y", "]"}], "]"}]}]}], "/.", 
      RowBox[{"\[Theta]1", "\[Rule]", 
       RowBox[{"xs", "-", "xt"}]}]}], "/.", 
     RowBox[{"\[Theta]2", "\[Rule]", 
      RowBox[{"ys", "-", "yt"}]}]}], "]"}], ",", 
   RowBox[{"Flatten", "[", 
    RowBox[{"Outer", "[", 
     RowBox[{"Times", ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", 
        RowBox[{
         RowBox[{"Sin", "[", "xt", "]"}], "^", "_."}], ",", 
        RowBox[{
         RowBox[{"Sin", "[", "yt", "]"}], "^", "_."}], ",", 
        RowBox[{
         RowBox[{"Cos", "[", "xt", "]"}], "^", "_."}], ",", 
        RowBox[{
         RowBox[{"Cos", "[", "yt", "]"}], "^", "_."}], ",", 
        RowBox[{"Sin", "[", "xt", "]"}], ",", 
        RowBox[{"Sin", "[", "yt", "]"}], ",", 
        RowBox[{"Cos", "[", "xt", "]"}], ",", 
        RowBox[{"Cos", "[", "yt", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", 
        RowBox[{
         RowBox[{"Sin", "[", "xt", "]"}], "^", "_."}], ",", 
        RowBox[{
         RowBox[{"Sin", "[", "yt", "]"}], "^", "_."}], ",", 
        RowBox[{
         RowBox[{"Cos", "[", "xt", "]"}], "^", "_."}], ",", 
        RowBox[{
         RowBox[{"Cos", "[", "yt", "]"}], "^", "_."}], ",", 
        RowBox[{"Sin", "[", "xt", "]"}], ",", 
        RowBox[{"Sin", "[", "yt", "]"}], ",", 
        RowBox[{"Cos", "[", "xt", "]"}], ",", 
        RowBox[{"Cos", "[", "yt", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", 
        RowBox[{
         RowBox[{"Sin", "[", "xt", "]"}], "^", "_."}], ",", 
        RowBox[{
         RowBox[{"Sin", "[", "yt", "]"}], "^", "_."}], ",", 
        RowBox[{
         RowBox[{"Cos", "[", "xt", "]"}], "^", "_."}], ",", 
        RowBox[{
         RowBox[{"Cos", "[", "yt", "]"}], "^", "_."}], ",", 
        RowBox[{"Sin", "[", "xt", "]"}], ",", 
        RowBox[{"Sin", "[", "yt", "]"}], ",", 
        RowBox[{"Cos", "[", "xt", "]"}], ",", 
        RowBox[{"Cos", "[", "yt", "]"}]}], "}"}]}], "]"}], "]"}], ",", 
   "Simplify"}], "]"}]], "Input",
 CellChangeTimes->{{3.694804729360321*^9, 3.6948047462306967`*^9}, {
   3.694804783734174*^9, 3.6948048419059277`*^9}, {3.69480488054099*^9, 
   3.694804927592146*^9}, 3.694805192998918*^9, {3.694805236766912*^9, 
   3.694805282919858*^9}, 3.6948053253990517`*^9, {3.694805647447995*^9, 
   3.69480570143128*^9}, {3.69480586401628*^9, 3.694805921624012*^9}, {
   3.69480595704202*^9, 3.6948059621758413`*^9}, {3.694805992504642*^9, 
   3.6948060711202803`*^9}, {3.694806305576713*^9, 3.6948063058958406`*^9}, {
   3.694819986487338*^9, 3.694820009255393*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"8", " ", "hcy", " ", 
   SuperscriptBox["hsx", "2"], " ", "u11", " ", 
   RowBox[{"(", 
    RowBox[{"u10", "+", 
     RowBox[{"2", " ", "hcy", " ", "u11"}], "+", 
     RowBox[{"4", " ", "hcx", " ", "u20"}], "+", 
     RowBox[{"2", " ", "hc2y", " ", "u21"}], "+", 
     RowBox[{"8", " ", "hcx", " ", "hcy", " ", "u21"}]}], ")"}], " ", 
   RowBox[{"Cos", "[", "xt", "]"}], " ", 
   RowBox[{"Cos", "[", "ys", "]"}], " ", 
   RowBox[{"Cos", "[", "yt", "]"}], " ", 
   RowBox[{"Sin", "[", "xs", "]"}]}], "+", 
  RowBox[{"8", " ", "hc2y", " ", 
   SuperscriptBox["hsx", "2"], " ", "u21", " ", 
   RowBox[{"(", 
    RowBox[{"u10", "+", 
     RowBox[{"2", " ", "hcy", " ", "u11"}], "+", 
     RowBox[{"4", " ", "hcx", " ", "u20"}], "+", 
     RowBox[{"2", " ", "hc2y", " ", "u21"}], "+", 
     RowBox[{"8", " ", "hcx", " ", "hcy", " ", "u21"}]}], ")"}], " ", 
   RowBox[{"Cos", "[", "xt", "]"}], " ", 
   RowBox[{"Cos", "[", 
    RowBox[{"2", " ", "ys"}], "]"}], " ", 
   SuperscriptBox[
    RowBox[{"Cos", "[", "yt", "]"}], "2"], " ", 
   RowBox[{"Sin", "[", "xs", "]"}]}], "+", 
  RowBox[{"8", " ", "hcx", " ", 
   SuperscriptBox["hsx", "2"], " ", "u20", " ", 
   RowBox[{"(", 
    RowBox[{"u10", "+", 
     RowBox[{"2", " ", "hcy", " ", "u11"}], "+", 
     RowBox[{"4", " ", "hcx", " ", "u20"}], "+", 
     RowBox[{"2", " ", "hc2y", " ", "u21"}], "+", 
     RowBox[{"8", " ", "hcx", " ", "hcy", " ", "u21"}]}], ")"}], " ", 
   SuperscriptBox[
    RowBox[{"Cos", "[", "xt", "]"}], "2"], " ", 
   RowBox[{"Sin", "[", 
    RowBox[{"2", " ", "xs"}], "]"}]}], "+", 
  RowBox[{"16", " ", "hcx", " ", "hcy", " ", 
   SuperscriptBox["hsx", "2"], " ", "u21", " ", 
   RowBox[{"(", 
    RowBox[{"u10", "+", 
     RowBox[{"2", " ", "hcy", " ", "u11"}], "+", 
     RowBox[{"4", " ", "hcx", " ", "u20"}], "+", 
     RowBox[{"2", " ", "hc2y", " ", "u21"}], "+", 
     RowBox[{"8", " ", "hcx", " ", "hcy", " ", "u21"}]}], ")"}], " ", 
   SuperscriptBox[
    RowBox[{"Cos", "[", "xt", "]"}], "2"], " ", 
   RowBox[{"Cos", "[", "ys", "]"}], " ", 
   RowBox[{"Cos", "[", "yt", "]"}], " ", 
   RowBox[{"Sin", "[", 
    RowBox[{"2", " ", "xs"}], "]"}]}], "-", 
  RowBox[{"4", " ", 
   SuperscriptBox["hsx", "2"], " ", "u10", " ", 
   RowBox[{"(", 
    RowBox[{"u10", "+", 
     RowBox[{"2", " ", "hcy", " ", "u11"}], "+", 
     RowBox[{"4", " ", "hcx", " ", "u20"}], "+", 
     RowBox[{"2", " ", "hc2y", " ", "u21"}], "+", 
     RowBox[{"8", " ", "hcx", " ", "hcy", " ", "u21"}]}], ")"}], " ", 
   RowBox[{"Cos", "[", "xs", "]"}], " ", 
   RowBox[{"Sin", "[", "xt", "]"}]}], "-", 
  RowBox[{"16", " ", "hcx", " ", 
   SuperscriptBox["hsx", "2"], " ", "u20", " ", 
   RowBox[{"(", 
    RowBox[{"u10", "+", 
     RowBox[{"2", " ", "hcy", " ", "u11"}], "+", 
     RowBox[{"4", " ", "hcx", " ", "u20"}], "+", 
     RowBox[{"2", " ", "hc2y", " ", "u21"}], "+", 
     RowBox[{"8", " ", "hcx", " ", "hcy", " ", "u21"}]}], ")"}], " ", 
   RowBox[{"Cos", "[", 
    RowBox[{"2", " ", "xs"}], "]"}], " ", 
   RowBox[{"Cos", "[", "xt", "]"}], " ", 
   RowBox[{"Sin", "[", "xt", "]"}]}], "-", 
  RowBox[{"8", " ", "hcy", " ", 
   SuperscriptBox["hsx", "2"], " ", "u11", " ", 
   RowBox[{"(", 
    RowBox[{"u10", "+", 
     RowBox[{"2", " ", "hcy", " ", "u11"}], "+", 
     RowBox[{"4", " ", "hcx", " ", "u20"}], "+", 
     RowBox[{"2", " ", "hc2y", " ", "u21"}], "+", 
     RowBox[{"8", " ", "hcx", " ", "hcy", " ", "u21"}]}], ")"}], " ", 
   RowBox[{"Cos", "[", "xs", "]"}], " ", 
   RowBox[{"Cos", "[", "ys", "]"}], " ", 
   RowBox[{"Cos", "[", "yt", "]"}], " ", 
   RowBox[{"Sin", "[", "xt", "]"}]}], "-", 
  RowBox[{"8", " ", "hc2y", " ", 
   SuperscriptBox["hsx", "2"], " ", "u21", " ", 
   RowBox[{"(", 
    RowBox[{"u10", "+", 
     RowBox[{"2", " ", "hcy", " ", "u11"}], "+", 
     RowBox[{"4", " ", "hcx", " ", "u20"}], "+", 
     RowBox[{"2", " ", "hc2y", " ", "u21"}], "+", 
     RowBox[{"8", " ", "hcx", " ", "hcy", " ", "u21"}]}], ")"}], " ", 
   RowBox[{"Cos", "[", "xs", "]"}], " ", 
   RowBox[{"Cos", "[", 
    RowBox[{"2", " ", "ys"}], "]"}], " ", 
   SuperscriptBox[
    RowBox[{"Cos", "[", "yt", "]"}], "2"], " ", 
   RowBox[{"Sin", "[", "xt", "]"}]}], "-", 
  RowBox[{"8", " ", "hcx", " ", 
   SuperscriptBox["hsx", "2"], " ", "u20", " ", 
   RowBox[{"(", 
    RowBox[{"u10", "+", 
     RowBox[{"2", " ", "hcy", " ", "u11"}], "+", 
     RowBox[{"4", " ", "hcx", " ", "u20"}], "+", 
     RowBox[{"2", " ", "hc2y", " ", "u21"}], "+", 
     RowBox[{"8", " ", "hcx", " ", "hcy", " ", "u21"}]}], ")"}], " ", 
   RowBox[{"Sin", "[", 
    RowBox[{"2", " ", "xs"}], "]"}], " ", 
   SuperscriptBox[
    RowBox[{"Sin", "[", "xt", "]"}], "2"]}], "-", 
  RowBox[{"16", " ", "hcx", " ", "hcy", " ", 
   SuperscriptBox["hsx", "2"], " ", "u21", " ", 
   RowBox[{"(", 
    RowBox[{"u10", "+", 
     RowBox[{"2", " ", "hcy", " ", "u11"}], "+", 
     RowBox[{"4", " ", "hcx", " ", "u20"}], "+", 
     RowBox[{"2", " ", "hc2y", " ", "u21"}], "+", 
     RowBox[{"8", " ", "hcx", " ", "hcy", " ", "u21"}]}], ")"}], " ", 
   RowBox[{"Cos", "[", "ys", "]"}], " ", 
   RowBox[{"Cos", "[", "yt", "]"}], " ", 
   RowBox[{"Sin", "[", 
    RowBox[{"2", " ", "xs"}], "]"}], " ", 
   SuperscriptBox[
    RowBox[{"Sin", "[", "xt", "]"}], "2"]}], "+", 
  RowBox[{"8", " ", "hcy", " ", 
   SuperscriptBox["hsx", "2"], " ", "u11", " ", 
   RowBox[{"(", 
    RowBox[{"u10", "+", 
     RowBox[{"2", " ", "hcy", " ", "u11"}], "+", 
     RowBox[{"4", " ", "hcx", " ", "u20"}], "+", 
     RowBox[{"2", " ", "hc2y", " ", "u21"}], "+", 
     RowBox[{"8", " ", "hcx", " ", "hcy", " ", "u21"}]}], ")"}], " ", 
   RowBox[{"Cos", "[", "xt", "]"}], " ", 
   RowBox[{"Sin", "[", "xs", "]"}], " ", 
   RowBox[{"Sin", "[", "ys", "]"}], " ", 
   RowBox[{"Sin", "[", "yt", "]"}]}], "+", 
  RowBox[{"16", " ", "hcx", " ", "hcy", " ", 
   SuperscriptBox["hsx", "2"], " ", "u21", " ", 
   RowBox[{"(", 
    RowBox[{"u10", "+", 
     RowBox[{"2", " ", "hcy", " ", "u11"}], "+", 
     RowBox[{"4", " ", "hcx", " ", "u20"}], "+", 
     RowBox[{"2", " ", "hc2y", " ", "u21"}], "+", 
     RowBox[{"8", " ", "hcx", " ", "hcy", " ", "u21"}]}], ")"}], " ", 
   SuperscriptBox[
    RowBox[{"Cos", "[", "xt", "]"}], "2"], " ", 
   RowBox[{"Sin", "[", 
    RowBox[{"2", " ", "xs"}], "]"}], " ", 
   RowBox[{"Sin", "[", "ys", "]"}], " ", 
   RowBox[{"Sin", "[", "yt", "]"}]}], "-", 
  RowBox[{"8", " ", "hcy", " ", 
   SuperscriptBox["hsx", "2"], " ", "u11", " ", 
   RowBox[{"(", 
    RowBox[{"u10", "+", 
     RowBox[{"2", " ", "hcy", " ", "u11"}], "+", 
     RowBox[{"4", " ", "hcx", " ", "u20"}], "+", 
     RowBox[{"2", " ", "hc2y", " ", "u21"}], "+", 
     RowBox[{"8", " ", "hcx", " ", "hcy", " ", "u21"}]}], ")"}], " ", 
   RowBox[{"Cos", "[", "xs", "]"}], " ", 
   RowBox[{"Sin", "[", "xt", "]"}], " ", 
   RowBox[{"Sin", "[", "ys", "]"}], " ", 
   RowBox[{"Sin", "[", "yt", "]"}]}], "-", 
  RowBox[{"16", " ", "hcx", " ", "hcy", " ", 
   SuperscriptBox["hsx", "2"], " ", "u21", " ", 
   RowBox[{"(", 
    RowBox[{"u10", "+", 
     RowBox[{"2", " ", "hcy", " ", "u11"}], "+", 
     RowBox[{"4", " ", "hcx", " ", "u20"}], "+", 
     RowBox[{"2", " ", "hc2y", " ", "u21"}], "+", 
     RowBox[{"8", " ", "hcx", " ", "hcy", " ", "u21"}]}], ")"}], " ", 
   RowBox[{"Sin", "[", 
    RowBox[{"2", " ", "xs"}], "]"}], " ", 
   SuperscriptBox[
    RowBox[{"Sin", "[", "xt", "]"}], "2"], " ", 
   RowBox[{"Sin", "[", "ys", "]"}], " ", 
   RowBox[{"Sin", "[", "yt", "]"}]}], "-", 
  RowBox[{"8", " ", "hc2y", " ", 
   SuperscriptBox["hsx", "2"], " ", "u21", " ", 
   RowBox[{"(", 
    RowBox[{"u10", "+", 
     RowBox[{"2", " ", "hcy", " ", "u11"}], "+", 
     RowBox[{"4", " ", "hcx", " ", "u20"}], "+", 
     RowBox[{"2", " ", "hc2y", " ", "u21"}], "+", 
     RowBox[{"8", " ", "hcx", " ", "hcy", " ", "u21"}]}], ")"}], " ", 
   RowBox[{"Cos", "[", "xt", "]"}], " ", 
   RowBox[{"Cos", "[", 
    RowBox[{"2", " ", "ys"}], "]"}], " ", 
   RowBox[{"Sin", "[", "xs", "]"}], " ", 
   SuperscriptBox[
    RowBox[{"Sin", "[", "yt", "]"}], "2"]}], "+", 
  RowBox[{"8", " ", "hc2y", " ", 
   SuperscriptBox["hsx", "2"], " ", "u21", " ", 
   RowBox[{"(", 
    RowBox[{"u10", "+", 
     RowBox[{"2", " ", "hcy", " ", "u11"}], "+", 
     RowBox[{"4", " ", "hcx", " ", "u20"}], "+", 
     RowBox[{"2", " ", "hc2y", " ", "u21"}], "+", 
     RowBox[{"8", " ", "hcx", " ", "hcy", " ", "u21"}]}], ")"}], " ", 
   RowBox[{"Cos", "[", "xs", "]"}], " ", 
   RowBox[{"Cos", "[", 
    RowBox[{"2", " ", "ys"}], "]"}], " ", 
   RowBox[{"Sin", "[", "xt", "]"}], " ", 
   SuperscriptBox[
    RowBox[{"Sin", "[", "yt", "]"}], "2"]}], "+", 
  RowBox[{
   RowBox[{"Cos", "[", "xt", "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"4", " ", 
      SuperscriptBox["hsx", "2"], " ", "u10", " ", 
      RowBox[{"(", 
       RowBox[{"u10", "+", 
        RowBox[{"2", " ", "hcy", " ", "u11"}], "+", 
        RowBox[{"4", " ", "hcx", " ", "u20"}], "+", 
        RowBox[{"2", " ", "hc2y", " ", "u21"}], "+", 
        RowBox[{"8", " ", "hcx", " ", "hcy", " ", "u21"}]}], ")"}], " ", 
      RowBox[{"Sin", "[", "xs", "]"}]}], "-", 
     RowBox[{"32", " ", "hcx", " ", "hcy", " ", 
      SuperscriptBox["hsx", "2"], " ", "u21", " ", 
      RowBox[{"(", 
       RowBox[{"u10", "+", 
        RowBox[{"2", " ", "hcy", " ", "u11"}], "+", 
        RowBox[{"4", " ", "hcx", " ", "u20"}], "+", 
        RowBox[{"2", " ", "hc2y", " ", "u21"}], "+", 
        RowBox[{"8", " ", "hcx", " ", "hcy", " ", "u21"}]}], ")"}], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"2", " ", "xs"}], "]"}], " ", 
      RowBox[{"Sin", "[", "xt", "]"}], " ", 
      RowBox[{"Sin", "[", "ys", "]"}], " ", 
      RowBox[{"Sin", "[", "yt", "]"}]}]}], ")"}]}], "+", 
  RowBox[{
   RowBox[{"Cos", "[", "yt", "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "32"}], " ", "hcx", " ", "hcy", " ", 
      SuperscriptBox["hsx", "2"], " ", "u21", " ", 
      RowBox[{"(", 
       RowBox[{"u10", "+", 
        RowBox[{"2", " ", "hcy", " ", "u11"}], "+", 
        RowBox[{"4", " ", "hcx", " ", "u20"}], "+", 
        RowBox[{"2", " ", "hc2y", " ", "u21"}], "+", 
        RowBox[{"8", " ", "hcx", " ", "hcy", " ", "u21"}]}], ")"}], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"2", " ", "xs"}], "]"}], " ", 
      RowBox[{"Cos", "[", "xt", "]"}], " ", 
      RowBox[{"Cos", "[", "ys", "]"}], " ", 
      RowBox[{"Sin", "[", "xt", "]"}]}], "+", 
     RowBox[{"16", " ", "hc2y", " ", 
      SuperscriptBox["hsx", "2"], " ", "u21", " ", 
      RowBox[{"(", 
       RowBox[{"u10", "+", 
        RowBox[{"2", " ", "hcy", " ", "u11"}], "+", 
        RowBox[{"4", " ", "hcx", " ", "u20"}], "+", 
        RowBox[{"2", " ", "hc2y", " ", "u21"}], "+", 
        RowBox[{"8", " ", "hcx", " ", "hcy", " ", "u21"}]}], ")"}], " ", 
      RowBox[{"Cos", "[", "xt", "]"}], " ", 
      RowBox[{"Sin", "[", "xs", "]"}], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"2", " ", "ys"}], "]"}], " ", 
      RowBox[{"Sin", "[", "yt", "]"}]}], "-", 
     RowBox[{"16", " ", "hc2y", " ", 
      SuperscriptBox["hsx", "2"], " ", "u21", " ", 
      RowBox[{"(", 
       RowBox[{"u10", "+", 
        RowBox[{"2", " ", "hcy", " ", "u11"}], "+", 
        RowBox[{"4", " ", "hcx", " ", "u20"}], "+", 
        RowBox[{"2", " ", "hc2y", " ", "u21"}], "+", 
        RowBox[{"8", " ", "hcx", " ", "hcy", " ", "u21"}]}], ")"}], " ", 
      RowBox[{"Cos", "[", "xs", "]"}], " ", 
      RowBox[{"Sin", "[", "xt", "]"}], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"2", " ", "ys"}], "]"}], " ", 
      RowBox[{"Sin", "[", "yt", "]"}]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{
  3.694805177350861*^9, 3.6948052536383677`*^9, 3.694805287600121*^9, {
   3.69480564927983*^9, 3.694805666977426*^9}, 3.694805703117783*^9, 
   3.694805737587079*^9, {3.694805908600923*^9, 3.6948059285650454`*^9}, 
   3.694805969084688*^9, {3.694806002680429*^9, 3.694806036496141*^9}, 
   3.694806077872939*^9, {3.69480621899482*^9, 3.6948062245109262`*^9}, 
   3.694806316289152*^9, 3.694807150485587*^9, 3.6948072127124557`*^9, {
   3.6948199497657833`*^9, 3.6948199896567183`*^9}, 3.694820050226042*^9, 
   3.695146509567505*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Manual Manipulations", "Section",
 CellChangeTimes->{{3.694790162405973*^9, 3.6947901684301567`*^9}}],

Cell[TextData[{
 "It should be noted that the nonlinear cos(thi),sin(thi) terms simplify into \
products of sines and cosines. For example, the fourier expansion of terms \
with index sum less than or equal to 3 (but excluding 0,+/-3 and +/-3,0) take \
the form\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["r", "1"], 
     RowBox[{"sin", "(", 
      SubscriptBox["\[Theta]", "1"], ")"}]}], "+", 
    RowBox[{
     SubscriptBox["r", "2"], 
     RowBox[{"cos", "(", 
      SubscriptBox["\[Theta]", "1"], ")"}], 
     RowBox[{"sin", "(", 
      SubscriptBox["\[Theta]", "1"], ")"}]}], "+", 
    RowBox[{
     SubscriptBox["r", "3"], 
     RowBox[{"cos", "(", 
      SubscriptBox["\[Theta]", "2"], ")"}], 
     RowBox[{"sin", "(", 
      SubscriptBox["\[Theta]", "1"], ")"}]}], "+", 
    RowBox[{
     SubscriptBox["r", "4"], 
     RowBox[{"cos", "(", 
      SubscriptBox["\[Theta]", "1"], ")"}], 
     RowBox[{"cos", "(", 
      SubscriptBox["\[Theta]", "2"], ")"}], 
     RowBox[{"sin", "(", 
      SubscriptBox["\[Theta]", "1"], ")"}]}], "+", 
    RowBox[{
     SubscriptBox["r", "5"], 
     RowBox[{
      SuperscriptBox["cos", "2"], "(", 
      SubscriptBox["\[Theta]", "2"], ")"}], 
     RowBox[{"sin", "(", 
      SubscriptBox["\[Theta]", "1"], ")"}]}], "+", 
    RowBox[{
     SubscriptBox["r", "6"], 
     RowBox[{"sin", "(", 
      SubscriptBox["\[Theta]", "1"], ")"}], 
     RowBox[{
      SuperscriptBox["sin", "2"], "(", 
      SubscriptBox["\[Theta]", "2"], ")"}]}]}], TraditionalForm]]],
 ".\nUsing half angle or double angle formulas, we may rewrite the terms \
above as the truncated Fourier series,\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["r", "1"], "+", 
       FractionBox[
        SubscriptBox["r", "5"], "2"], "+", 
       SubscriptBox["r", "6"]}], ")"}], 
     RowBox[{"sin", "(", 
      SubscriptBox["\[Theta]", "1"], ")"}]}], "+", 
    RowBox[{
     SubscriptBox["r", "2"], 
     RowBox[{"sin", "(", 
      SubscriptBox["\[Theta]", "1"], ")"}], 
     RowBox[{"cos", "(", 
      SubscriptBox["\[Theta]", "1"], ")"}]}], "+", 
    RowBox[{
     SubscriptBox["r", "3"], 
     RowBox[{"sin", "(", 
      SubscriptBox["\[Theta]", "1"], ")"}], 
     RowBox[{"cos", "(", 
      SubscriptBox["\[Theta]", "2"], ")"}]}], "+", 
    RowBox[{
     FractionBox[
      SubscriptBox["r", "4"], "2"], 
     RowBox[{"sin", "(", 
      RowBox[{"2", 
       SubscriptBox["\[Theta]", "1"]}], ")"}], 
     RowBox[{"cos", "(", 
      SubscriptBox["\[Theta]", "2"], ")"}]}], "+", 
    RowBox[{
     FractionBox[
      SubscriptBox["r", "5"], "2"], 
     RowBox[{"sin", "(", 
      SubscriptBox["\[Theta]", "1"], ")"}], 
     RowBox[{"cos", "(", 
      RowBox[{"2", 
       SubscriptBox["\[Theta]", "2"]}], ")"}]}]}], TraditionalForm]]],
 ", which we rewrite as\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["h", "1"], 
     RowBox[{"sin", "(", 
      SubscriptBox["\[Theta]", "1"], ")"}]}], "+", 
    RowBox[{
     SubscriptBox["h", "2"], 
     RowBox[{"sin", "(", 
      SubscriptBox["\[Theta]", "1"], ")"}], 
     RowBox[{"cos", "(", 
      SubscriptBox["\[Theta]", "1"], ")"}]}], "+", 
    RowBox[{
     SubscriptBox["h", "3"], 
     RowBox[{"sin", "(", 
      SubscriptBox["\[Theta]", "1"], ")"}], 
     RowBox[{"cos", "(", 
      SubscriptBox["\[Theta]", "2"], ")"}]}], "+", 
    RowBox[{
     SubscriptBox["h", "4"], 
     RowBox[{"sin", "(", 
      RowBox[{"2", 
       SubscriptBox["\[Theta]", "1"]}], ")"}], 
     RowBox[{"cos", "(", 
      SubscriptBox["\[Theta]", "2"], ")"}]}], "+", 
    RowBox[{
     SubscriptBox["h", "5"], 
     RowBox[{"sin", "(", 
      SubscriptBox["\[Theta]", "1"], ")"}], 
     RowBox[{"cos", "(", 
      RowBox[{"2", 
       SubscriptBox["\[Theta]", "2"]}], ")"}]}]}], TraditionalForm]]]
}], "Text",
 CellChangeTimes->{{3.6947160730646152`*^9, 3.6947164068663177`*^9}, {
  3.6947869374298563`*^9, 3.694786959922505*^9}, {3.694807955666072*^9, 
  3.69480798570827*^9}}],

Cell["\<\
With a steady-state Fourier mode trunction up to index sum 3 (but excluding \
0,3 and 3,0), we have 6 terms for the H function trunction as seen above. We \
simplify these terms assuming they have been run through the integral of H. \
Thus, H takes the form
\
\>", "Text",
 CellChangeTimes->{{3.694789729736505*^9, 3.694789843513463*^9}, {
  3.694806788754983*^9, 3.694806955496646*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Collect", "[", 
             RowBox[{
              RowBox[{"TrigExpand", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"h1", "*", 
                    RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], "+", 
                    RowBox[{"h2", "*", 
                    RowBox[{"Cos", "[", "\[Theta]1", "]"}], "*", 
                    RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], "+", 
                    RowBox[{"h3", "*", 
                    RowBox[{"Cos", "[", "\[Theta]2", "]"}], "*", 
                    RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], "+", 
                    RowBox[{"h4", "*", 
                    RowBox[{"Cos", "[", "\[Theta]2", "]"}], "*", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"2", " ", "\[Theta]1"}], "]"}]}], "+", 
                    RowBox[{"h5", "*", 
                    RowBox[{"Cos", "[", 
                    RowBox[{"2", " ", "\[Theta]2"}], "]"}], "*", 
                    RowBox[{"Sin", "[", "\[Theta]1", "]"}]}]}], "/.", 
                   RowBox[{
                    RowBox[{"Cos", "[", "x", "]"}], "\[Rule]", 
                    RowBox[{"Inactive", "[", 
                    RowBox[{"Cos", "[", "x", "]"}], "]"}]}]}], "/.", 
                  RowBox[{
                   RowBox[{"Cos", "[", "y", "]"}], "\[Rule]", 
                   RowBox[{"Inactive", "[", 
                    RowBox[{"Cos", "[", "y", "]"}], "]"}]}]}], "/.", 
                 RowBox[{"\[Theta]1", "\[Rule]", 
                  RowBox[{"xs", "-", "xt"}]}]}], "/.", 
                RowBox[{"\[Theta]2", "\[Rule]", 
                 RowBox[{"ys", "-", "yt"}]}]}], "]"}], ",", 
              RowBox[{"Flatten", "[", 
               RowBox[{"Outer", "[", 
                RowBox[{"Times", ",", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{
                    RowBox[{"Sin", "[", "xt", "]"}], "^", "_."}], ",", 
                   RowBox[{
                    RowBox[{"Sin", "[", "yt", "]"}], "^", "_."}], ",", 
                   RowBox[{
                    RowBox[{"Cos", "[", "xt", "]"}], "^", "_."}], ",", 
                   RowBox[{
                    RowBox[{"Cos", "[", "yt", "]"}], "^", "_."}]}], "}"}], 
                 ",", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{
                    RowBox[{"Sin", "[", "xt", "]"}], "^", "_."}], ",", 
                   RowBox[{
                    RowBox[{"Sin", "[", "yt", "]"}], "^", "_."}], ",", 
                   RowBox[{
                    RowBox[{"Cos", "[", "xt", "]"}], "^", "_."}], ",", 
                   RowBox[{
                    RowBox[{"Cos", "[", "yt", "]"}], "^", "_."}]}], "}"}], 
                 ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Sin", "[", "xt", "]"}], "^", "_."}], ",", 
                   RowBox[{
                    RowBox[{"Sin", "[", "yt", "]"}], "^", "_."}], ",", 
                   RowBox[{
                    RowBox[{"Cos", "[", "xt", "]"}], "^", "_."}], ",", 
                   RowBox[{
                    RowBox[{"Cos", "[", "yt", "]"}], "^", "_."}]}], "}"}], 
                 ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Sin", "[", "xt", "]"}], "^", "_."}], ",", 
                   RowBox[{
                    RowBox[{"Sin", "[", "yt", "]"}], "^", "_."}], ",", 
                   RowBox[{
                    RowBox[{"Cos", "[", "xt", "]"}], "^", "_."}], ",", 
                   RowBox[{
                    RowBox[{"Cos", "[", "yt", "]"}], "^", "_."}]}], "}"}]}], 
                "]"}], "]"}], ",", "Simplify"}], "]"}], "/.", 
            RowBox[{
             RowBox[{"Cos", "[", "xt", "]"}], "\[Rule]", "cx"}]}], "/.", 
           RowBox[{
            RowBox[{"Sin", "[", "xs", "]"}], "\[Rule]", "sxs"}]}], "/.", 
          RowBox[{
           RowBox[{"Cos", "[", "yt", "]"}], "\[Rule]", "cy"}]}], "/.", 
         RowBox[{
          RowBox[{"Cos", "[", "ys", "]"}], "\[Rule]", "cys"}]}], "/.", 
        RowBox[{
         RowBox[{"Cos", "[", "xs", "]"}], "\[Rule]", "cxs"}]}], "/.", 
       RowBox[{
        RowBox[{"Cos", "[", 
         RowBox[{"2", "ys"}], "]"}], "\[Rule]", "c2ys"}]}], "/.", 
      RowBox[{
       RowBox[{"Sin", "[", 
        RowBox[{"2", "xs"}], "]"}], "\[Rule]", "s2xs"}]}], "/.", 
     RowBox[{
      RowBox[{"Sin", "[", "xt", "]"}], "\[Rule]", "sx"}]}], "/.", 
    RowBox[{
     RowBox[{"Cos", "[", 
      RowBox[{"2", "xs"}], "]"}], "\[Rule]", "c2xs"}]}], "/.", 
   RowBox[{
    RowBox[{"Sin", "[", "ys", "]"}], "\[Rule]", "sys"}]}], "/.", 
  RowBox[{
   RowBox[{"Sin", "[", "yt", "]"}], "\[Rule]", "sy"}]}]], "Input",
 CellChangeTimes->{{3.69480813961874*^9, 3.694808192540962*^9}, {
  3.69480857324291*^9, 3.694808621506919*^9}, {3.694808664659154*^9, 
  3.694808820234701*^9}, {3.6948200746552057`*^9, 3.694820082407887*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SuperscriptBox["cx", "2"], " ", "cy", " ", "cys", " ", "h4", " ", "s2xs"}],
   "-", 
  RowBox[{"cxs", " ", "h1", " ", "sx"}], "-", 
  RowBox[{"cxs", " ", "cy", " ", "cys", " ", "h3", " ", "sx"}], "+", 
  RowBox[{"cx", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "c2xs"}], " ", "h2"}], "-", 
     RowBox[{"2", " ", "c2xs", " ", "cy", " ", "cys", " ", "h4"}]}], ")"}], 
   " ", "sx"}], "-", 
  RowBox[{"c2ys", " ", "cxs", " ", 
   SuperscriptBox["cy", "2"], " ", "h5", " ", "sx"}], "+", 
  RowBox[{"cx", " ", "h1", " ", "sxs"}], "+", 
  RowBox[{
   SuperscriptBox["cx", "2"], " ", "cxs", " ", "h2", " ", "sxs"}], "+", 
  RowBox[{"cx", " ", "cy", " ", "cys", " ", "h3", " ", "sxs"}], "+", 
  RowBox[{"c2ys", " ", "cx", " ", 
   SuperscriptBox["cy", "2"], " ", "h5", " ", "sxs"}], "-", 
  RowBox[{"cxs", " ", "h2", " ", 
   SuperscriptBox["sx", "2"], " ", "sxs"}], "-", 
  RowBox[{"2", " ", "cxs", " ", "cy", " ", "cys", " ", "h4", " ", 
   SuperscriptBox["sx", "2"], " ", "sxs"}], "+", 
  RowBox[{"c2ys", " ", "cxs", " ", "h5", " ", "sx", " ", 
   SuperscriptBox["sy", "2"]}], "-", 
  RowBox[{"c2ys", " ", "cx", " ", "h5", " ", "sxs", " ", 
   SuperscriptBox["sy", "2"]}], "+", 
  RowBox[{
   SuperscriptBox["cx", "2"], " ", "h4", " ", "s2xs", " ", "sy", " ", "sys"}],
   "-", 
  RowBox[{"2", " ", "cxs", " ", "h4", " ", 
   SuperscriptBox["sx", "2"], " ", "sxs", " ", "sy", " ", "sys"}], "+", 
  RowBox[{"sx", " ", "sy", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "cxs"}], " ", "h3", " ", "sys"}], "-", 
     RowBox[{"2", " ", "c2xs", " ", "cx", " ", "h4", " ", "sys"}], "-", 
     RowBox[{
     "4", " ", "cxs", " ", "cy", " ", "cys", " ", "h5", " ", "sys"}]}], 
    ")"}]}], "+", 
  RowBox[{"cx", " ", "sy", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"h3", " ", "sxs", " ", "sys"}], "+", 
     RowBox[{
     "4", " ", "cy", " ", "cys", " ", "h5", " ", "sxs", " ", "sys"}]}], 
    ")"}]}]}]], "Output",
 CellChangeTimes->{
  3.694808144760511*^9, 3.694808194817067*^9, {3.694808588867269*^9, 
   3.694808621956971*^9}, {3.694808700748805*^9, 3.694808821469709*^9}, {
   3.694819950153289*^9, 3.694819967924614*^9}, 3.695146509990529*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Scratch work", "Section",
 CellChangeTimes->{{3.694786698722333*^9, 3.6947867047622013`*^9}}],

Cell["\<\
All work below this point may be cleared at any time. If the results are \
important enough, save above or to some other location.\
\>", "Text",
 CellChangeTimes->{{3.694786708306375*^9, 3.6947867261300707`*^9}, {
  3.6947869217234287`*^9, 3.694786922762371*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"CoefficientList", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"r1", "*", 
      RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], " ", "+", " ", 
     RowBox[{"r2", "*", 
      RowBox[{"Cos", "[", "\[Theta]1", "]"}], "*", 
      RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], " ", "+", " ", 
     RowBox[{"r3", "*", 
      RowBox[{"Cos", "[", "\[Theta]2", "]"}], "*", 
      RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], " ", "+", " ", 
     RowBox[{"r4", "*", 
      RowBox[{"Cos", "[", "\[Theta]1", "]"}], "*", 
      RowBox[{"Cos", "[", "\[Theta]2", "]"}], "*", 
      RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], " ", "+", " ", 
     RowBox[{"r5", "*", 
      RowBox[{
       RowBox[{"Cos", "[", "\[Theta]2", "]"}], "^", "2"}], "*", 
      RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], " ", "+", " ", 
     RowBox[{"r6", "*", 
      RowBox[{"Sin", "[", "\[Theta]1", "]"}], "*", 
      RowBox[{
       RowBox[{"Sin", "[", "\[Theta]2", "]"}], "^", "2"}]}]}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Sin", "[", "\[Theta]1", "]"}], ",", 
      RowBox[{"Cos", "[", "\[Theta]1", "]"}], ",", 
      RowBox[{"Cos", "[", "\[Theta]2", "]"}], ",", 
      RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "}"}]}], "]"}], "//", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.694807419512508*^9, 3.694807462392988*^9}, {
  3.694807533778969*^9, 3.69480756111302*^9}, {3.694807827642042*^9, 
  3.6948078277295837`*^9}, {3.694807882650222*^9, 3.694807883105895*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"0", "0", "0"},
         {"0", "0", "0"},
         {"0", "0", "0"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"0", "0", "0"},
         {"0", "0", "0"},
         {"0", "0", "0"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}]},
     {
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"r1", "0", "r6"},
         {"r3", "0", "0"},
         {"r5", "0", "0"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"r2", "0", "0"},
         {"r4", "0", "0"},
         {"0", "0", "0"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.6948074433433723`*^9, 3.694807463681188*^9}, 
   3.69480756132652*^9, 3.6948078283480253`*^9, 3.694807883392295*^9, {
   3.694819950242435*^9, 3.694819968015644*^9}, 3.6951465100278053`*^9}]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1871, 1056},
WindowMargins->{{-49, Automatic}, {Automatic, -24}},
FrontEndVersion->"10.2 for Linux x86 (64-bit) (July 29, 2015)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 179, 4, 32, "Input"],
Cell[740, 26, 1725, 42, 55, "Input"],
Cell[2468, 70, 1200, 35, 99, "Input"],
Cell[CellGroupData[{
Cell[3693, 109, 2022, 54, 55, "Input"],
Cell[5718, 165, 1075, 26, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[6830, 196, 537, 16, 55, "Input"],
Cell[7370, 214, 1227, 28, 32, "Output"],
Cell[8600, 244, 595, 9, 32, "Output"]
}, Open  ]],
Cell[9210, 256, 461, 12, 32, "Input"],
Cell[9674, 270, 388, 11, 32, "Input"],
Cell[CellGroupData[{
Cell[10087, 285, 1249, 28, 55, "Input"],
Cell[11339, 315, 1362, 29, 32, "Output"],
Cell[12704, 346, 1974, 47, 32, "Output"]
}, Open  ]],
Cell[14693, 396, 651, 10, 51, "Text"],
Cell[CellGroupData[{
Cell[15369, 410, 916, 15, 55, "Input"],
Cell[16288, 427, 1954, 47, 32, "Output"],
Cell[18245, 476, 2002, 49, 32, "Output"]
}, Open  ]],
Cell[20262, 528, 4653, 146, 80, "Input"],
Cell[CellGroupData[{
Cell[24940, 678, 1670, 32, 55, "Input"],
Cell[26613, 712, 4360, 92, 79, "Output"],
Cell[30976, 806, 2380, 45, 32, "Output"]
}, Open  ]],
Cell[33371, 854, 7498, 194, 147, "Input"],
Cell[40872, 1050, 1163, 39, 52, "Text"],
Cell[CellGroupData[{
Cell[42060, 1093, 5540, 113, 101, "Input"],
Cell[47603, 1208, 4778, 126, 127, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[52418, 1339, 157, 3, 32, "Input"],
Cell[52578, 1344, 1557, 24, 136, "Output"]
}, Open  ]],
Cell[54150, 1371, 481, 8, 31, "Text"],
Cell[54634, 1381, 130, 1, 31, "Text"],
Cell[CellGroupData[{
Cell[54789, 1386, 766, 20, 32, "Input"],
Cell[55558, 1408, 3410, 81, 81, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[59005, 1494, 3014, 73, 99, "Input"],
Cell[62022, 1569, 12092, 286, 340, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[74151, 1860, 107, 1, 67, "Section"],
Cell[74261, 1863, 4027, 125, 144, "Text"],
Cell[78291, 1990, 397, 8, 50, "Text"],
Cell[CellGroupData[{
Cell[78713, 2002, 5274, 122, 99, "Input"],
Cell[83990, 2126, 2231, 54, 58, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[86270, 2186, 99, 1, 67, "Section"],
Cell[86372, 2189, 273, 5, 31, "Text"],
Cell[CellGroupData[{
Cell[86670, 2198, 1475, 34, 55, "Input"],
Cell[88148, 2234, 3196, 84, 187, "Output"]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
