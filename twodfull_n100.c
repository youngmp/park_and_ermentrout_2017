#include <math.h>
#define pi 3.14159265358979323
#include <time.h>

get2d(double *in,double *out,int nin,int nout, double *var, double *con)
{

  double a0=in[0],a10=in[1],a01=in[2],b10=in[3],b01=in[4],a11=in[5];
  double b11=in[6],c11=in[7],d11=in[8],r=in[9],theta=in[10];
  int n=100;
  double p0=0,p10=0,p01=0,q10=0,q01=0,p11=0,q11=0,r11=0,s11=0;
  double cx,cy,sx,sy,cxy,sxy,sxcy,sycx,u,f;
  double dx=pi/n,dx2=dx*dx;

  int i,j;
  double c[] = {-1.0 , -0.999506560366 , -0.998026728428 , -0.995561964603 , -0.992114701314 , -0.987688340595 , -0.982287250729 , -0.975916761939 , -0.968583161129 , -0.960293685677 , -0.951056516295 , -0.940880768954 , -0.929776485888 , -0.917754625684 , -0.904827052466 , -0.891006524188 , -0.876306680044 , -0.860742027004 , -0.844327925502 , -0.827080574275 , -0.809016994375 , -0.790155012376 , -0.770513242776 , -0.75011106963 , -0.728968627421 , -0.707106781187 , -0.684547105929 , -0.661311865324 , -0.637423989749 , -0.612907053653 , -0.587785252292 , -0.562083377852 , -0.535826794979 , -0.50904141575 , -0.481753674102 , -0.45399049974 , -0.425779291565 , -0.397147890635 , -0.368124552685 , -0.338737920245 , -0.309016994375 , -0.278991106039 , -0.248689887165 , -0.218143241397 , -0.187381314586 , -0.15643446504 , -0.125333233564 , -0.0941083133185 , -0.0627905195293 , -0.0314107590781 , -1.60812264968e-16 , 0.0314107590781 , 0.0627905195293 , 0.0941083133185 , 0.125333233564 , 0.15643446504 , 0.187381314586 , 0.218143241397 , 0.248689887165 , 0.278991106039 , 0.309016994375 , 0.338737920245 , 0.368124552685 , 0.397147890635 , 0.425779291565 , 0.45399049974 , 0.481753674102 , 0.50904141575 , 0.535826794979 , 0.562083377852 , 0.587785252292 , 0.612907053653 , 0.637423989749 , 0.661311865324 , 0.684547105929 , 0.707106781187 , 0.728968627421 , 0.75011106963 , 0.770513242776 , 0.790155012376 , 0.809016994375 , 0.827080574275 , 0.844327925502 , 0.860742027004 , 0.876306680044 , 0.891006524188 , 0.904827052466 , 0.917754625684 , 0.929776485888 , 0.940880768954 , 0.951056516295 , 0.960293685677 , 0.968583161129 , 0.975916761939 , 0.982287250729 , 0.987688340595 , 0.992114701314 , 0.995561964603 , 0.998026728428 , 0.999506560366 , 1.0 , 0.999506560366 , 0.998026728428 , 0.995561964603 , 0.992114701314 , 0.987688340595 , 0.982287250729 , 0.975916761939 , 0.968583161129 , 0.960293685677 , 0.951056516295 , 0.940880768954 , 0.929776485888 , 0.917754625684 , 0.904827052466 , 0.891006524188 , 0.876306680044 , 0.860742027004 , 0.844327925502 , 0.827080574275 , 0.809016994375 , 0.790155012376 , 0.770513242776 , 0.75011106963 , 0.728968627421 , 0.707106781187 , 0.684547105929 , 0.661311865324 , 0.637423989749 , 0.612907053653 , 0.587785252292 , 0.562083377852 , 0.535826794979 , 0.50904141575 , 0.481753674102 , 0.45399049974 , 0.425779291565 , 0.397147890635 , 0.368124552685 , 0.338737920245 , 0.309016994375 , 0.278991106039 , 0.248689887165 , 0.218143241397 , 0.187381314586 , 0.15643446504 , 0.125333233564 , 0.0941083133185 , 0.0627905195293 , 0.0314107590781 , -1.60812264968e-16 , -0.0314107590781 , -0.0627905195293 , -0.0941083133185 , -0.125333233564 , -0.15643446504 , -0.187381314586 , -0.218143241397 , -0.248689887165 , -0.278991106039 , -0.309016994375 , -0.338737920245 , -0.368124552685 , -0.397147890635 , -0.425779291565 , -0.45399049974 , -0.481753674102 , -0.50904141575 , -0.535826794979 , -0.562083377852 , -0.587785252292 , -0.612907053653 , -0.637423989749 , -0.661311865324 , -0.684547105929 , -0.707106781187 , -0.728968627421 , -0.75011106963 , -0.770513242776 , -0.790155012376 , -0.809016994375 , -0.827080574275 , -0.844327925502 , -0.860742027004 , -0.876306680044 , -0.891006524188 , -0.904827052466 , -0.917754625684 , -0.929776485888 , -0.940880768954 , -0.951056516295 , -0.960293685677 , -0.968583161129 , -0.975916761939 , -0.982287250729 , -0.987688340595 , -0.992114701314 , -0.995561964603 , -0.998026728428 , -0.999506560366};

  double s[] = {3.21624529935e-16 , -0.0314107590781 , -0.0627905195293 , -0.0941083133185 , -0.125333233564 , -0.15643446504 , -0.187381314586 , -0.218143241397 , -0.248689887165 , -0.278991106039 , -0.309016994375 , -0.338737920245 , -0.368124552685 , -0.397147890635 , -0.425779291565 , -0.45399049974 , -0.481753674102 , -0.50904141575 , -0.535826794979 , -0.562083377852 , -0.587785252292 , -0.612907053653 , -0.637423989749 , -0.661311865324 , -0.684547105929 , -0.707106781187 , -0.728968627421 , -0.75011106963 , -0.770513242776 , -0.790155012376 , -0.809016994375 , -0.827080574275 , -0.844327925502 , -0.860742027004 , -0.876306680044 , -0.891006524188 , -0.904827052466 , -0.917754625684 , -0.929776485888 , -0.940880768954 , -0.951056516295 , -0.960293685677 , -0.968583161129 , -0.975916761939 , -0.982287250729 , -0.987688340595 , -0.992114701314 , -0.995561964603 , -0.998026728428 , -0.999506560366 , -1.0 , -0.999506560366 , -0.998026728428 , -0.995561964603 , -0.992114701314 , -0.987688340595 , -0.982287250729 , -0.975916761939 , -0.968583161129 , -0.960293685677 , -0.951056516295 , -0.940880768954 , -0.929776485888 , -0.917754625684 , -0.904827052466 , -0.891006524188 , -0.876306680044 , -0.860742027004 , -0.844327925502 , -0.827080574275 , -0.809016994375 , -0.790155012376 , -0.770513242776 , -0.75011106963 , -0.728968627421 , -0.707106781187 , -0.684547105929 , -0.661311865324 , -0.637423989749 , -0.612907053653 , -0.587785252292 , -0.562083377852 , -0.535826794979 , -0.50904141575 , -0.481753674102 , -0.45399049974 , -0.425779291565 , -0.397147890635 , -0.368124552685 , -0.338737920245 , -0.309016994375 , -0.278991106039 , -0.248689887165 , -0.218143241397 , -0.187381314586 , -0.15643446504 , -0.125333233564 , -0.0941083133185 , -0.0627905195293 , -0.0314107590781 , 0.0 , 0.0314107590781 , 0.0627905195293 , 0.0941083133185 , 0.125333233564 , 0.15643446504 , 0.187381314586 , 0.218143241397 , 0.248689887165 , 0.278991106039 , 0.309016994375 , 0.338737920245 , 0.368124552685 , 0.397147890635 , 0.425779291565 , 0.45399049974 , 0.481753674102 , 0.50904141575 , 0.535826794979 , 0.562083377852 , 0.587785252292 , 0.612907053653 , 0.637423989749 , 0.661311865324 , 0.684547105929 , 0.707106781187 , 0.728968627421 , 0.75011106963 , 0.770513242776 , 0.790155012376 , 0.809016994375 , 0.827080574275 , 0.844327925502 , 0.860742027004 , 0.876306680044 , 0.891006524188 , 0.904827052466 , 0.917754625684 , 0.929776485888 , 0.940880768954 , 0.951056516295 , 0.960293685677 , 0.968583161129 , 0.975916761939 , 0.982287250729 , 0.987688340595 , 0.992114701314 , 0.995561964603 , 0.998026728428 , 0.999506560366 , 1.0 , 0.999506560366 , 0.998026728428 , 0.995561964603 , 0.992114701314 , 0.987688340595 , 0.982287250729 , 0.975916761939 , 0.968583161129 , 0.960293685677 , 0.951056516295 , 0.940880768954 , 0.929776485888 , 0.917754625684 , 0.904827052466 , 0.891006524188 , 0.876306680044 , 0.860742027004 , 0.844327925502 , 0.827080574275 , 0.809016994375 , 0.790155012376 , 0.770513242776 , 0.75011106963 , 0.728968627421 , 0.707106781187 , 0.684547105929 , 0.661311865324 , 0.637423989749 , 0.612907053653 , 0.587785252292 , 0.562083377852 , 0.535826794979 , 0.50904141575 , 0.481753674102 , 0.45399049974 , 0.425779291565 , 0.397147890635 , 0.368124552685 , 0.338737920245 , 0.309016994375 , 0.278991106039 , 0.248689887165 , 0.218143241397 , 0.187381314586 , 0.15643446504 , 0.125333233564 , 0.0941083133185 , 0.0627905195293 , 0.0314107590781};

  /*   printf("%d %g %g %g %g %g %g \n",n,a0,a10,a01,a11,r,theta); */
  for(i=-n;i<n;i++){
      cy=c[i+n];
      sy=s[i+n];

    for(j=-n;j<n;j++){
      cx=c[j+n];    
      sx=s[j+n];


      cxy=cx*cy;
      sxy=sx*sy;
      sxcy=sx*cy;
      sycx=sy*cx;


      u=a0+a10*cx+a01*cy+a11*cxy+b10*sx+b01*sy+b11*sxy+c11*sxcy+d11*sycx;
      f=1/(1+exp(-r*(u-theta)));
      p0+=f; /* a0 */
      p10+=(cx*f); /* a10 */
      p01+=(cy*f); /* a01 */
      p11+=(cxy*f); /* a11 */
      q10+=(sx*f); /* b10 */
      q01+=(sy*f); /* b01 */
      q11+=(sxy*f); /* b11 */
      r11+=(sxcy*f); /* c11 */
      s11+=(sycx*f); /* d11 */
   
    }
  }



  out[0]=p0*dx2; /* a0 */
  out[1]=p10*dx2; /* a10 */
  out[2]=p01*dx2;
  out[3]=q10*dx2;
  out[4]=q01*dx2;
  out[5]=p11*dx2;
  out[6]=q11*dx2;
  out[7]=r11*dx2;
  out[8]=s11*dx2;
}

	
  
  
